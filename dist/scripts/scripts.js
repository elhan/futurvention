!function(){"use strict";var a=angular.module("fvApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","mgcrea.ngStrap","mgcrea.ngStrap.modal","mgcrea.ngStrap.helpers.dimensions","mgcrea.ngStrap.helpers.parseOptions","mgcrea.ngStrap.tooltip","mgcrea.ngStrap.select","mgcrea.ngStrap.tab","mgcrea.ngStrap.collapse","mgcrea.ngStrap.button","mgcrea.ngStrap.alert","mgcrea.ngStrap.typeahead","config","angularFileUpload","ngImgCrop","duScroll","angular-carousel","ui.validate","breeze.angular","angucomplete"]);a.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html"}).when("/register",{templateUrl:"views/register.html",controller:"RegistrationCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/forgotPassword",{templateUrl:"views/forgotPassword.html",controller:"ForgotPwdCtrl"}).when("/resetPassword",{templateUrl:"views/resetPassword.html",controller:"ResetPwdCtrl"}).when("/apply",{templateUrl:"views/apply.html"}).when("/storefront/:moniker",{templateUrl:"views/storefront.html",controller:"StorefrontCtrl",resolve:{profile:["$route","$q","ProfileSvc",function(a,b,c){var d=b.defer();return c.fetchProfile(a.current.params.moniker).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}]}}).when("/offer/:offerId",{templateUrl:"views/offer.html",controller:"OfferCtrl",resolve:{offer:["$route","OfferSvc",function(a,b){return b.fetchOffer(a.current.params.offerId)}]}}).otherwise({redirectTo:"/"})}]),a.value("duScrollGreedy",!0),a.config(["$alertProvider","$httpProvider",function(a,b){b.defaults.withCredentials=!0,b.defaults.useXDomain=!0,delete b.defaults.headers.common["X-Requested-With"],b.responseInterceptors.push(["$rootScope","$q","$location","PATHS","MESSAGES","EVENTS",function(a,b,c,d,e,f){return function(e){return e.then(function(a){return a},function(e){return 401===e.status?(console.log(e),e.config.url!==d.account.userInfo&&(a.$broadcast(f.auth.sessionTimeout,event),c.path("/login")),e):b.reject(e)})}}]),angular.extend(a.defaults,{animation:"am-fade-and-slide-top",placement:"top",duration:4,dismissable:!0,template:"views/components/alert.html"})}]),a.run(["breeze",function(a){!a&&console.log("breeze not loaded!")}])}(),function(){"use strict";angular.module("config",[]).constant("ENV",{name:"production",apiEndpoint:"http://futurvention.herokuapp.com",fbApiKey:"675990215825778",liApiKey:"77xj8xhasosg9k",firebaseUrl:"https://fvapp.firebaseio.com/"})}(),function(){"use strict";var a=angular.module("fvApp");a.constant("EVENTS",{profile:{fetchProfileFailed:"fetch-profile-failed",profileUpdated:"profile-updated"},user:{createSuccess:"user-creation-success",createFailed:"user-creation-failed",updateSuccess:"user-update-success",updateFailed:"user-update-failed"},auth:{registrationSuccess:"auth-registration-success",registrationFailed:"auth-registration-failed",loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"},importer:{profileReady:"imp-profile-ready",portfoliosReady:"imp-portfolios-ready",reviewsReady:"imp-reviews-ready"},ui:{providerSelected:"ui-provider-selected"}}),a.constant("USER_ROLES",{all:"*",admin:"admin",user:"user",guest:"guest"}),a.constant("PATHS",{root:"https://futurvention.azurewebsites.net","public":"https://futurvention.azurewebsites.net/public.svc/",cached:"https://futurvention.azurewebsites.net/CachedPublic.svc/",account:{register:"https://futurvention.azurewebsites.net/api/Account/Register",login:"https://futurvention.azurewebsites.net/api/Account/Login",logout:"https://futurvention.azurewebsites.net/api/Account/Logout",userInfo:"https://futurvention.azurewebsites.net/api/Account/UserInfo",resetPassword:"https://futurvention.azurewebsites.net/api/Account/ChangePassword",externalLogins:"https://futurvention.azurewebsites.net/api/Account/ExternalLogins?returnUrl=http://client.futurvention.com:9000&generateState=true"},importer:{"import":"https://futurvention.azurewebsites.net/api/ExtService/import",checkProgress:"https://futurvention.azurewebsites.net/api/ExtService/checkprogress",fetchProfile:"https://futurvention.azurewebsites.net/api/ExtService/getprofiles",fetchPortfolios:"https://futurvention.azurewebsites.net/api/ExtService/getportfolios"},sellerManagement:{profile:"https://futurvention.azurewebsites.net/api/SellerManagement/Profiles/",ownProfile:"https://futurvention.azurewebsites.net/api/SellerManagement/Profiles/OwnProfile",profileStatus:"https://futurvention.azurewebsites.net/api/SellerManagement/Profiles/OwnProfile/Status",monikerExists:function(a){return["https://futurvention.azurewebsites.net/api/SellerManagement/Profiles/",a,"/exists"].join("")}},user:{self:"https://futurvention.azurewebsites.net/api/Self?expand=Avatar",ownAvatar:"https://futurvention.azurewebsites.net/api/Self/Avatar"},file:{hosted:"https://ergmaimages.blob.core.windows.net/userdata/"}}),a.constant("ROUTES",{"public":["/","/login","/register"]}),a.constant("EMBEDLY",{key:"05b548d0a515404f8f3da52d93eb402f",domain:"http://api.embed.ly/1/",oembedAPI:"oembed"}),a.constant("MESSAGES",{error:{generic:"Something went wrong. Please try again later.",logoutFailed:"Something went wrong. Please try logging out again.",profileImportFailed:"No profiles could be imported"},success:{createNewPassword:"We sent you an email. Follow the instructions to create a new password.",resetPassword:"Your password has been reset!",profileImported:"Your profile has been imported from "}}),a.constant("IMPORT_PROVIDERS",["linkedin","odesk","elance","pph","freelancer","behance","dribbble","github"]),a.constant("PROVIDERS_ENUM",{behance:1,dribbble:2,elance:3,freelancer:4,github:5,odesk:6,peopleperhour:7})}(),function(){"use strict";var a=angular.module("fvApp");a.directive("fvSlider",["$document","$timeout",function(a,b){var c=40,d=38;return{restrict:"E",templateUrl:"views/directives/fv-slider.html",link:function(e,f,g){function h(a){b(function(){"up"===e.direction?e.index++:e.index--},l*a)}function i(){return function(a){var b=window.event||a,c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail));return e.$apply(e.goToSlide(0>c?e.index+1:e.index-1)),!1}}function j(a){a.keyCode===c&&e.$apply(function(){e.goToSlide(e.index+1)}),a.keyCode===d&&e.$apply(function(){e.goToSlide(e.index-1)})}var k=600,l=200,m=!1;g.fullscreen&&angular.element("body").css("overflow","hidden"),e.options={fullscreen:g.fullscreen,keyboard:g.keyboard,count:g.count||0,slidename:g.slidename||"slide",indicator:g.indicator,navbtn:g.navbtn},e.slides=[];for(var n=0;n<g.count;n++)e.slides.push(g.slidename+n);e.index=0,e.direction="up",e.speed=800,e.goToSlide=function(a){var c=0;if(!(m||0>a||a===e.slides.length)){m=!0,b(function(){m=!1},1e3,!1),e.direction=e.index>a?"down":"up",c=Math.abs(e.index-a),e.speed=k-(c-1)*l;for(var d=0;c>d;d++)h(d)}},angular.element(a).on("keydown",j),document.addEventListener&&(document.addEventListener("mousewheel",i(),!1),document.addEventListener("DOMMouseScroll",i(),!1)),e.$on("$destroy",function(){g.fullscreen&&angular.element("body").css("overflow","auto"),angular.element(a).off("keydown"),angular.element(a).off("mousewheel"),angular.element(a).off("DOMMouseScroll")})}}}]),a.directive("fvScrollBottom",["$window","$document","$timeout",function(a,b,c){return{restrict:"A",link:function(d,e,f){d.$on(f.scrolltrigger,function(){c(function(){a.scrollTo(0,angular.element(b)[0].body.scrollHeight)})})}}}]),a.directive("fvScrollTo",["$document","$timeout",function(a,b){return{restrict:"A",link:function(c,d,e){b(e.fvScrollTo&&a.scrollToElement(d))}}}]),a.directive("fvAutoFocus",["$timeout",function(a){return{restrict:"A",link:function(b,c){c&&c.focus&&a(function(){c.focus()})}}}]),a.directive("fvFocusInput",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){var b=document.getElementsByName(d.focusInput)[0];b&&c.on(d.focusOn,function(){a(function(){b.focus()})})})}}}]),a.directive("fvBgImage",["$timeout",function(){return{restrict:"A",link:function(a,b,c){c.$observe("fvBgImage",function(a,c){a&&a!==c&&b.css("background-image",['url("',a,'")'].join(""))},!0)}}}]),a.directive("fvDraggable",function(){return function(a,b,c){var d=b[0];return c.fvDraggable===!1?void d.removeAttr("draggable"):(d.draggable=!0,void d.addEventListener("dragstart",function(a){return a.dataTransfer.effectAllowed="move",c.fvData&&a.dataTransfer.setData("Text",JSON.stringify(c.fvData)),!1},!1))}}),a.directive("fvDroppable",function(){return{scope:{},link:function(a,b,c){var d=b[0];c.fvDropClass&&d.addEventListener("dragenter",function(){return this.classList.add(c.fvDropClass),!1},!1),c.fvDropClass&&d.addEventListener("dragleave",function(){return this.classList.remove(c.fvDropClass),!1},!1),d.addEventListener("dragover",function(a){return a.preventDefault&&a.preventDefault(),a.dataTransfer.dropEffect="move",!1},!1),d.addEventListener("drop",function(a){return a.stopPropagation&&a.stopPropagation(),c.fvDropClass&&this.classList.remove(c.fvDropClass),!1},!1)}}}),a.directive("fvOnDrop",function(){return{restrict:"A",link:function(a,b,c){b[0].addEventListener("drop",function(b){a.$apply(_.bind(a[c.fvOnDrop],{event:b},a.item))})}}}),a.directive("fvTimelineH",function(){return{restrict:"E",templateUrl:"views/directives/fv-timeline-h.html",link:function(){}}}),a.directive("fvDynamicName",["$compile","$parse",function(a,b){return{restrict:"A",terminal:!0,priority:1e5,link:function(c,d){var e=b(d.attr("fv-dynamic-name"))(c);d.removeAttr("fv-dynamic-name"),d.attr("name",["input","-",e].join("")),a(d)(c)}}}]),a.directive("fvToggleClass",function(){return function(a,b,c){c.fvOn&&c.fvClass&&b[0].addEventListener(c.fvOn,function(){this.classList.toggle(c.fvClass)})}}),a.directive("fvTabs",function(){return function(a,b){var c=_.filter(b.children(),function(a){return a.hasAttribute("fv-pane")});_.forEach(c,function(b,c){b.addEventListener("click",function(){a.$emit("pane-clicked",c)})}),a.$on("pane-clicked",function(a,b){_.forEach(c,function(a,c){b===c?angular.element(a).addClass("active"):angular.element(a).removeClass("active")})})}})}(),function(){"use strict";var a=angular.module("fvApp");a.service("ReviewSvc",["$http","$q","$timeout","Enum",function(a,b,c,d){var e={};return e.fetchReceivedReviews=function(a,e,f){console.log(a,e,f);for(var g=_.values(d.Providers),h=_.random(0,g.length),i=function(){return{reviewer:{firstName:"Mark",lastName:"Twain"},provider:g[h],rating:_.random(1,5),timeAgo:"3 days ago",text:"Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. "}},j=_.random(3,20),k=[],l=0;j>l;l++)k.push(new i);var m=b.defer();return c(function(){m.resolve(k)}),m.promise},e}]),a.service("MessagingSvc",["$http","$q","$timeout",function(a,b,c){var d={};return d.sendMessage=function(a,d,e,f,g){console.log(g);var h=b.defer();return c(function(){h.resolve(g)}),h.promise},d}]),a.service("NotificationSvc",["$http","$q","$alert",function(a,b,c){var d={};return d.show=function(a){var d=c(a),e=b.defer();return e.resolve(d),e.promise},d}]),a.service("EmbedlySvc",["$http","EMBEDLY",function(a,b){this.oembed=function(c,d,e){return a.get([b.domain,b.oembedAPI,"?key=",b.key,"&urls=",_.pluck(c,"url").map(encodeURI).join(","),"&maxwidth=",d,"&maxheight=",e,"&format=json"].join(""))}}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("Enum",function(){var a={};return a.OfferStatus=Object.freeze({AUDIO:"audio",IMAGE:"image",INLINE_TEXT:"inline_text",TEXT:"text",VIDEO:"video"}),a.ShowcaseFileType=Object.freeze({LINKED:"linked",HOSTED:"hosted"}),a.Providers=Object.freeze({LINKEDIN:"linkedIn",ODESK:"oDesk",ELANCE:"elance",PPH:"pph",FREELANCER:"freelancer",BEHANCE:"behance",DRIBBBLE:"dribbble",GITHUB:"github"}),a})}(),function(){"use strict";var a=angular.module("fvApp");a.service("Utils",function(){var a={};return a.updateProperties=function(a,b){return b&&_.forOwn(a,function(c,d){b.hasOwnProperty(d)&&(a[d]=b[d])}),a},a.removeEmptyProperties=function(a){var b,c,d;return _.pick(a,function(a){return b=typeof a===Number&&0===a,c=null===a,d=a instanceof Array&&0===a.length,!b&&!c&&!d})},a.capitalize=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},a.capitalizeKeys=function(b){var c={},d=_.values(b);return _.each(_.keys(b),function(b,e){c[a.capitalize(b)]=d[e]}),c},a.camelCaseKeys=function(b){if(_.isObject(b)){var c={},d=_.values(b);return _.each(_.keys(b),function(e,f){/[a-z]/.test(e)?c[e.charAt(0).toLowerCase()+e.slice(1)]=_.isObject(b[e])?a.camelCaseKeys(d[f]):d[f]:c[e]=d[f]}),c}},a.URL_PATTERN=/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#!\(\)-]*[\w@?^=%&amp;\/~+#-])?/gim,a.PSEUDO_URL_PATTERN=/(^|[^\/])(www\.[\S]+(\b|$))/gim,a.ELANCE_URL_PATTERN=/^http[s]?:\/\/([^\/]*elance.com)/i,a.isVideo=function(a){var b=new RegExp(/video\/*/g);return b.test(a)},a.getUrlParams=function(a){var b,c;if(a){for(var d=0;d<a.length;++d)c=a[d].split("=",2),b[c[0]]=1===c.length?"":decodeURIComponent(c[1].replace(/\+/g," "));return b}},a.testEmailPattern=function(a){return/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/im.test(a)},a}),Array.prototype.hasOwnProperty("swap")||(Array.prototype.swap=function(a,b){var c=this[a];return this[a]=this[b],this[b]=c,this}),Array.prototype.hasOwnProperty("empty")||(Array.prototype.empty=function(){for(;this.length>0;)this.pop()}),Array.prototype.hasOwnProperty("removed")||(Array.prototype.remove=function(a){if("function"!=typeof a)return void 0;for(var b=0;b<this.length;b++)if(a(this[b]))return this.splice(b,1);return void 0}),Array.prototype.hasOwnProperty("merge")||(Array.prototype.merge=function(a){if(!(a instanceof Array))return void 0;for(var b=0;b<a.length;b++)this.push(a[b]);return this}),Function.prototype.hasOwnProperty("method")||(Function.prototype.method=function(a,b){return this.prototype[a]=b,this}),Function.prototype.hasOwnProperty("inherits")||Function.method("inherits",function(a){return this.prototype=new a,this.prototype.constructor=parent,this}),Function.prototype.hasOwnProperty("inheritFunctions")||(Function.prototype.inheritFunctions=function(a,b){if(a&&b&&a instanceof Object&&b instanceof Array){for(var c,d=this,e=0;e<b.length;e++)c=b[e],a.hasOwnProperty(c)&&a[c]instanceof Function&&(d.prototype[c]=a[c]);return d}})}(),function(){"use strict";var a=angular.module("fvApp");a.filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),a.filter("prizmUrl",function(){return function(a){return["http://connect.ajaxdocumentviewer.com/?key=K4102014161530&viewertype=html5&document=",a,"&viewerheight=100%&viewerwidth=100%&printButton=Yes&toolbarColor=CCCCCC"].join("")}})}(),function(){"use strict";var a=angular.module("fvApp");a.factory("Odata",["Utils","PROVIDERS_ENUM",function(a){var b={},c={};return c.setMultilingual=function(a,c){var d=this;switch(!0){case!c||!d.hasOwnProperty(a):break;case null===d[a]:d[a]=new b.Multilingual({Literals:[new b.Literal({Text:c})]});break;case d[a]instanceof b.Multilingual:d[a].Literals[0].Text=c}return d},b.Literal=function(b){var c=this;c.ID=0,c.Text=null,c.LanguageID=1,c.IsDefault=!0,a.updateProperties(c,b)},b.Multilingual=function(b){var c=this;c.ID=0,c.Literals=[],a.updateProperties(c,b)},b.Location=function(b){var c=this;c.ID=0,c.ParentID=0,c.Name=null,a.updateProperties(c,b)},b.Location.method("getName",function(){return this.Name&&this.Name.Literals[0].Text}),b.SellerProfile=function(b){var c=this;c.ID=0,c.Moniker=null,c.FirstName=null,c.LastName=null,c.Title=null,c.Description=null,c.Resume=null,c.Status=null,c.LocationID=0,c.UserID=0,c.Showcases=[],c.Reviews=[],a.updateProperties(c,b)},b.SellerProfile.prototype.fromImported=function(c){if(c){var d=this;return a.updateProperties(d,{FirstName:c.FirstName,LastName:c.LastName,Description:new b.Multilingual({Literals:[new b.Literal({Text:c.Bio})]}),Title:new b.Multilingual({Literals:[new b.Literal({Text:c.Headline})]})}),d}},b.SellerProfile.inheritFunctions(c,["setMultilingual"]),b.User=function(b){var c=this;c.ID=0,c.Guid="",c.Avatar=null,c.AvatarID=0,c.IsSystem=!1,c.IsAnonymous=!1,c.FirstName=null,c.LastName=null,c.PreferredLanguageID=1,c.Registrations=[],c.Roles=[],a.updateProperties(c,b)},b.File=function(b){var c=this;c.FileType=null,c.FileTypeID=null,c.Name=null,c.OwnerID=0,a.updateProperties(c,b)},b.FileType=function(b){var c=this;c.ID=0,c.Name=0,c.AllowedInServiceFields=[],c.AllowedInServices=[],c.MediumCategory=0,c.MimeTypes=0,a.updateProperties(c,b)},b.Showcase=function(b){var c=this;c.Description=null,c.Title=null,c.Items=[],c.Offers=[],c.Order=0,c.SellerProfileID=0,c.SourceID=0,a.updateProperties(c,b)},b.Showcase.prototype.fromImported=function(c){if(c){var d=this;return a.updateProperties(d,{Description:c.Description?new b.Multilingual({Literals:[new b.Literal({Text:c.Description})]}):null,Title:new b.Multilingual({Literals:[new b.Literal({Text:c.Description})]}),Items:[(new b.ShowcaseItem).fromImported(c)]}),d}},b.ShowcaseItem=function(b){var c=this;c.Description=null,c.Title=null,c.Order=0,c.ShowcaseID=0,c.Showcase=null,c.FileID=0,c.File=null,c.ThumbnailID=0,c.Thumbnail=null,a.updateProperties(c,b)},b.ShowcaseItem.prototype.fromImported=function(c,d){if(c){var e=this;return a.updateProperties(e,{Description:c.Description?new b.Multilingual({Literals:[new b.Literal({Text:c.Description})]}):null,Title:new b.Multilingual({Literals:[new b.Literal({Text:c.Description})]}),File:(new b.File).fromImported(c),Thumbnail:(new b.File).fromImported(c,"thumbnail"),Showcase:d?d:null}),e}},b}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("MainCtrl",["$scope","$location","$q","$cookies","$timeout","EVENTS","MESSAGES","ROUTES","PATHS","Utils","Odata","AccountSvc","NotificationSvc","ProfileSvc","UserSvc",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){a.currentUser={},a.avatar={},a.session={},a.updateCurrentUser=function(b){angular.extend(a.currentUser,b)},a.go=function(a){var d=c.defer();return b.path(a),d.resolve(),d.promise},a.locationAt=function(a){return a===b.path()},a.$on("$routeChangeStart",function(b,c){!a.session.hasRegistered&&-1===h.public.indexOf(c.originalPath)&&a.go("/")}),a.$on("$routeChangeError",function(b,c,d,e){console.log(e),m.show({content:g.error.generic,type:"error"}),a.go("/")}),a.$on(f.auth.loginSuccess,function(){l.getUserInfo().then(function(b){a.session=b,a.go(a.locationAt("/register")?"/apply":"/")},function(a){console.log(a),m.show({content:g.error.generic,type:"error"})})}),a.$on(f.auth.logoutSuccess,function(){a.session={},a.go("/")}),a.$on(f.auth.logoutFailed,function(){m.show({content:g.error.logoutFailed,type:"error"})}),a.$on(f.user.updateSuccess,function(b,c){a.currentUser=c,a.avatar=encodeURI(i.file.hosted+c.Avatar.RelativeUrl)}),a.$watch("session",function(b,c){switch(!0){case b===c:return;case _.isEmpty(b):a.currentUser={};break;default:o.fetchUser()}}),b.search().error&&a.go("/login").then(function(){b.url(b.path()),m.show({content:b.search().error,type:"error"})}),l.getUserInfo().then(function(b){a.session=b},function(a){console.log(a)})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("RegistrationCtrl",["$scope","$rootScope","EVENTS","Utils","AccountSvc",function(a,b,c,d,e){a.newUser={firstName:"",lastName:"",email:"",password:""},a.authError={email:[],password:[]},a.register=function(b){return b?void e.externalLogin(b):void e.register(a.newUser).then(function(){e.getUserInfo().then(function(a){console.log(a)},function(a){console.log(a)})},function(a){console.log(a)})},a.isEmail=function(a){return d.testEmailPattern(a)},a.hasDigits=function(a){return/\d+/g.test(a)},a.hasNonAlphanumeric=function(a){return/\W/g.test(a)},a.hasLowercase=function(a){return/[a-z]/.test(a)},a.hasUppercase=function(a){return/[A-Z]/.test(a)},a.$on(c.auth.registrationFailed,function(b,c){switch(c.status){case"EMAIL_TAKEN":a.authError.emailTaken=a.newUser.email;break;case"INVALID_EMAIL":a.authError.invalidEmail=a.newUser.email;break;default:console.log(b,c)}})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("LoginCtrl",["$scope","$rootScope","EVENTS","MESSAGES","Utils","AccountSvc","NotificationSvc",function(a,b,c,d,e,f,g){a.newUser={email:"",password:""},a.authError={credentials:!1},a.clearAuthError=function(){a.authError.credentials=!1},a.login=function(e){return e?void f.externalLogin(e):void f.login(a.newUser).then(function(){b.$broadcast(c.auth.loginSuccess,event)},function(b){switch(console.log(b),b.status){case 401:a.authError.credentials=!0;break;default:console.log(event,b),g.show({content:d.error.generic,type:"error"})}})},a.isEmail=function(a){return e.testEmailPattern(a)},a.hasDigits=function(a){return/\d+/g.test(a)},a.hasNonAlphanumeric=function(a){return/\W/g.test(a)},a.hasLowercase=function(a){return/[a-z]/.test(a)},a.hasUppercase=function(a){return/[A-Z]/.test(a)}}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("StorefrontCtrl",["$scope","$modal","$timeout","$location","ProfileSvc","PortfolioSvc","OfferSvc","ReviewSvc","MessagingSvc","NotificationSvc","profile","userId","EVENTS",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=b({scope:a,template:"views/components/modalContactUser.html",show:!1,animation:"am-slide-top",keyboard:!1}),o=b({scope:a,template:"views/components/modalPortfolioViewer.html",show:!1,animation:"am-slide-top",keyboard:!1}),p=b({scope:a,template:"views/components/modalImageCrop.html",show:!1,animation:"am-slide-top",keyboard:!0});a.portfolio=f.getPortfolio(),a.profile=k,a.userId=l,a.isCurrentUser=d.absUrl()===a.profile.personalUrl,a.reviews={},a.offers=[],a.message="",a.sender={firstName:"",lastName:"",email:""},a.steps=e.getSteps(),a.activeStep=a.steps[4],a.range=function(a){return _.range(0,a)},a.contactUser=function(){i.sendMessage(a.userId,a.currentUser.id,a.sender.firstName,a.sender.lastName,a.message).then(function(){j.show({content:"Your message was successfuly sent!",type:"success"}).then(function(){c(a.closeContactModal)})},function(a){console.log(a)})},a.editProfileSection=function(b){e.setActiveStep(b),a.go("/apply")},a.removeOffer=function(b){g.removeOffer(b),a.offers=g.offers},a.editOffer=function(b){g.setOffer(_.find(a.offers,function(a){return a.serviceName===b})),g.fetchOffer(b,a.userId).then(function(b){g.setOffer(b),a.activeStep=a.steps[3]},function(a){console.log(a)}),a.editProfileSection("offer_config")},a.showContactModal=function(){n.$promise.then(n.show)},a.closeContactModal=function(){n.$promise.then(n.hide)},a.showPortfolioViewerModal=function(){o.$promise.then(o.show)},a.showImageCropModal=function(){a.isCurrentUser&&p.$promise.then(function(){a.croppedImage="",p.show()})},g.fetchOffers(a.userId).then(function(b){a.offers=b},function(a){console.log(a)}),h.fetchReceivedReviews(a.userId).then(function(b){a.reviews=b},function(a){console.log(a)}),a.$on(m.profile.profileUpdated,function(){a.profile.image=e.getProfile().image})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ServiceSelectCtrl",["$scope","$timeout","EVENTS","MESSAGES","CatalogueSvc","OfferSvc","NotificationSvc","ImporterSvc",function(a,b,c,d,e,f,g,h){a.offset=0,a.batch=e.batch,a.offers=[],a.services=[],a.categories=[],a.allServices=[],a.selectedService={},a.getServices=function(){e.getServices(a.offset).then(function(b){a.services.merge(b),a.services.totalCount=b.length,a.allServices=e.services},function(a){console.log(a)})},a.getServicesUnderCategory=function(b){e.getServicesUnderCategory(b,a.offset).then(function(b){a.services.merge(b.services),a.services.totalCount=b.totalCount},function(a){console.log(a)})},a.showMore=function(){a.offset+=a.batch;var b=a.categories[a.categories.activeCategoryIndex].categoryID;null===b?a.getServices():a.getServicesUnderCategory(b)},e.getRootCategories().then(function(b){a.categories=b,a.categories.activeCategoryIndex=0},function(a){console.log(a)}),a.createOffer=function(c){f.setOffer(new f.Offer),f.updateOffer({serviceID:c}),b(function(){a.goToStep(3)})},a.$watch("categories.activeCategoryIndex",function(b,c){switch(!0){case void 0===typeof b||b===c||0===a.categories.length:break;case 0===b:a.offset=0,a.services.empty(),a.getServices();break;default:a.offset=0,a.services.empty(),a.getServicesUnderCategory(a.categories[b].categoryID)}}),a.$watch("selectedService.serviceID",function(b){b&&a.createOffer(b)}),a.try=function(){console.log(h.getImporters("portfoliosDone")),console.log(h.getImporters("profileDone")),console.log(h.getImporters("reviewsDone"))}}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("OfferConfigCtrl",["$scope","$timeout","$modal","$upload","$location","CatalogueSvc","EmbedlySvc","ProfileSvc","OfferSvc","PortfolioSvc","ImporterSvc",function(a,b,c,d,e,f,g,h,i,j,k){a.urlsToEmbed=[{url:""}],a.showcaseItems=[],a.offer=i.getOffer(),a.service={},a.priceDiscriminators=[],a.addons=[],a.deadlines=["1 day","2 days","3 days","4 days","5 days","6 days","7 days","8 days","9 days","10 days"],a.extraDeadlines=["1 extra day","2 extra days","3 extra days","4 extra days","5 extra days","6 extra days","7 extra days","8 extra days","9 extra days","10 extra days"],a.offer=i.getOffer(),f.getService(a.offer.serviceID).then(function(b){console.log(b),a.service=b,a.priceDiscriminators=_.filter(b.options,function(a){return a.isPriceDiscriminator&&a.isMandatory}),a.addons=_.filter(b.options,function(a){return a.isPriceDiscriminator&&!a.isMandatory})},function(a){console.log(a)}),a.panels=[{title:"Service Description",state:"default"},{title:"Work Samples",state:"default"},{title:"Personalize your offering",state:"default",textonly:!1},{title:"Pricing / Deadlines",state:"default"}],a.panels.activePanel=0,b(function(){a.panels.activePanel=0});var l=c({scope:a,template:"views/components/modalEmbedUrl.html",show:!1,keyboard:!1,animation:"am-slide-top"}),m=c({scope:a,template:"views/components/modalCameraTag.html",show:!1,keyboard:!1,backdrop:"static",animation:"am-slide-top"});a.showEmbedUrlModal=_.throttle(function(){l.$promise.then(function(){l.show()})},700),a.showCameraTagModal=function(){m.$promise.then(function(){m.show()})},a.closeEmbedUrlModal=function(){a.urlsToEmbed.empty(),l.hide()},a.closeCameraTagModal=function(){m.hide()},a.addUrls=function(){g.oembed(a.urlsToEmbed).then(function(b){_.each(b.data,function(b){a.showcaseItems.push({name:b.thumbnail_url,link:b.thumbnail_url,state:"loaded"}),a.closeEmbedUrlModal()})},function(a){console.log(a)})},a.setPanelState=function(a,b){a.state=b},a.closePanel=function(b){a.setPanelState(b,"done"),a.panels.activePanel=a.panels.indexOf(_.find(a.panels,function(a){return"default"===a.state}))},a.onFileSelect=function(b){_.each(b,function(b){var c;_.where(a.showcaseItems,{name:b.name}).length>0||(a.showcaseItems.push({name:"Loading...",link:"",state:"loading"}),c=a.showcaseItems.length-1,d.upload({url:"http://localhost:3000/upload",method:"POST",headers:{"x-filename":b.name},file:b}).success(function(){var d=new FileReader;d.onload=function(d){a.$apply(function(){_.assign(a.showcaseItems[c],{name:b.name,link:d.target.result,state:"loaded"})})},d.readAsDataURL(b)}).error(function(d){console.log(d);var e=new FileReader;e.onload=function(d){a.$apply(function(){_.assign(a.showcaseItems[c],{name:b.name,link:d.target.result,state:"loaded"})})},e.readAsDataURL(b)}))})},a.rearangeShowcaseItems=function(b){var c,d,e=JSON.parse(this.event.dataTransfer.getData("Text")),f=b.link;e!==f&&(c=a.showcaseItems.indexOf(_.where(a.showcaseItems,{link:e})[0]),d=a.showcaseItems.indexOf(_.where(a.showcaseItems,{link:f})[0]),a.showcaseItems=a.showcaseItems.swap(c,d))},a.toggleSelection=function(a){switch(a.state){case"selected":a.state="loaded";break;case"loaded":a.state="selected";break;default:return}},a.toggleTextOnly=function(){var b=a.panels[a.panels.activePanel];b.hasOwnProperty("textonly")&&(b.textonly=!b.textonly)},k.fetchPortfolios().then(function(a){console.log(a)},function(a){console.log(a)}),a.$watch("panels.activePanel",function(){var b=_.find(a.panels,function(a){return"done"!==a.state});!b&&a.goToStep(2)}),a.$on("modal.show",function(){CameraTag.setup(),CameraTag.observe("fvcam","published",function(){var a=CameraTag.cameras.fvcam,b=a.getVideo();console.log(b)})})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ApplyCtrl",["$scope","ProfileSvc",function(a,b){a.steps=b.getSteps(),a.activeStep=b.getActiveStep(),a.goToStep=function(c){a.activeStep=a.steps[c],b.setActiveStep(a.activeStep)},a.goToStep(0)}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ApplyInfoCtrl",["$scope","$modal","$timeout","EVENTS","Utils","Odata","ProfileSvc","LocationSvc","ImporterSvc","NotificationSvc",function(a,b,c,d,e,f,g,h,i,j){var k=b({scope:a,template:"views/components/modalImageCrop.html",show:!1,animation:"am-slide-top",keyboard:!0});a.profile=g.getProfile(),a.profileExists=!1,a.showImageCropModal=function(){k.$promise.then(function(){a.croppedImage="",k.show()})},a.monikerIsValid=!1,a.title="",a.bio="",a.city={},a.cities=[],a.cityName="",a.cityNames=[],a.countries=[],a.countryName="",a.countryNames=[],a.validateMoniker=function(){g.validateMoniker(a.profile.Moniker).then(function(b){a.monikerIsValid=!b.data},function(a){console.log(a)})},a.continue=function(){a.profileExists?g.patchProfile(e.removeEmptyProperties(a.profile),a.profile.ID).then(function(a){console.log(a)},function(a){console.log(a)}):g.createProfile(e.removeEmptyProperties(a.profile)).then(function(a){console.log(a)},function(a){console.log(a)})},a.searchCity=_.throttle(function(b){b&&h.searchCity(a.country.ID,b).then(function(b){c(function(){a.cities=b,a.cityNames=_.map(b,function(a){return a.getName()})})},function(a){console.log(a)})},700),a.$watch("profile",function(b,c){b&&b!==c&&(a.countryName=_.find(a.countries,function(b){return b.ID===a.profile.LocationID}).getName())}),a.$watch("cityName",function(b,c){b&&b!==c&&(a.city=_.find(a.cities,function(b){return b.getName()===a.cityName}),a.profile.LocationID=a.city&&a.city.ID)}),a.$watch("countryName",function(b,c){b&&b!==c&&(a.country=_.find(a.countries,function(b){return b.getName()===a.countryName}))}),a.$watch("profile.Moniker",function(b,c){b&&b!==c&&a.validateMoniker()}),a.$watch("bio",function(b,c){b&&b!==c&&a.profile.setMultilingual("Description",b)}),a.$watch("title",function(b,c){b&&b!==c&&a.profile.setMultilingual("Title",b)}),a.$on(d.importer.reviewsReady,function(a,b){j.show({content:"Reviews imported from "+b.provider,type:"success"})}),a.$on(d.profile.profileUpdated,function(){c(function(){a.profile=g.getProfile()})}),h.getCountries().then(function(b){a.countries=b,a.countryNames=_.map(b,function(a){return a.getName()})},function(a){console.log(a)}),g.fetchProfileStatus().then(function(){a.profileExists=!0,g.fetchOwnProfile().then(function(){c(function(){a.profile=g.getProfile()})},function(a){console.log(a)})},function(){a.profileExists=!1,i.fetchProfile().then(function(){c(function(){a.profile=g.getProfile()})},function(a){console.log(a)})})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ApplyImportCtrl",["$scope","EVENTS","MESSAGES","ImporterSvc","NotificationSvc",function(a,b,c,d,e){a.importers=d.getImporters(),a.selected=new d.ImporterCollection,a.selectedImporters=a.selected.importers,a.done=d.getImporters("profileDone"),a.toggleSelection=function(c){return a.isSelected(c)?void _.remove(a.selectedImporters,c):(a.selectedImporters.push(c),void a.$broadcast(b.ui.providerSelected,c.provider))
},a.isSelected=function(b){return a.selectedImporters.indexOf(b)>-1},a.import=function(){d.import(a.selectedImporters)},a.$on(b.importer.profileReady,function(b,d){e.show({content:c.success.profileImported+d.provider,type:"success"}),a.goToStep(1)})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("OfferCtrl",["$scope","offer","ReviewSvc","UserSvc","PortfolioSvc","CatalogueSvc","$modal",function(a,b,c,d,e,f,g){a.reviews=[],a.portfolio={},a.service={},a.offer=b;var h=g({scope:a,template:"views/components/modalContactUser.html",show:!1,animation:"am-slide-top",keyboard:!1});a.range=function(a){return _.range(0,a)},a.showContactModal=function(){h.$promise.then(h.show)},a.closeContactModal=function(){h.$promise.then(h.hide)},c.fetchReceivedReviews(a.user.userId).then(function(b){a.reviews=b},function(a){console.log(a)}),f.getService().then(function(b){a.service=b},function(a){console.log(a)})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ModalImageCropCtrl",["$rootScope","$scope","$timeout","$upload","PATHS","EVENTS","MESSAGES","UserSvc","NotificationSvc",function(a,b,c,d,e,f,g,h,i){b.file={},b.init=function(a){b.uncroppedImage="",b.croppedImage="",b.tempImage="",b.setProgress(a)},b.updateCroppedImage=function(a){b.croppedImage=a},b.onFileSelect=function(a){var d=new FileReader;d.onloadstart=function(){b.setProgress(!0)},d.onload=function(a){c(function(){b.uncroppedImage=a.target.result,b.setProgress(!1)})},d.readAsDataURL(a[0]),b.file=a[0]},b.setProgress=function(a){b.inProgress=a},b.saveAvatar=function(){d.upload({url:e.user.ownAvatar,file:b.file,fileFormDataName:b.file.name}).then(function(){h.fetchUser().then(function(){b.$hide()},function(a){console.log(a),i.show({content:g.error.generic,type:"error"})})},function(a){console.log(a)})},b.init()}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ForgotPwdCtrl",["$scope","AccountSvc","MESSAGES","NotificationSvc",function(a,b,c,d){a.email="",a.forgotPassword=function(){b.forgotPassword(a.email).then(function(b){console.log(b),d.show({content:c.success.createNewPassword,type:"success"}).then(function(){a.go("/login")})},function(){d.show({content:c.error.generic,type:"error"})})}}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ResetPwdCtrl",["$scope","MESSAGES","AccountSvc","NotificationSvc",function(a,b,c,d){a.oldPassword="",a.newPassword="",a.confirmPassword="",a.resetPassword=function(){var e={OldPassword:a.oldPassword,NewPassword:a.newPassword,ConfirmPassword:a.confirmPassword};c.resetPassword(e).then(function(){d.show({content:b.success.resetPassword,type:"success"}).then(function(){a.go("/login")})},function(){d.show({content:b.error.generic,type:"error"})})}}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("HeaderCtrl",["$scope","$rootScope","EVENTS","AccountSvc",function(a,b,c,d){a.logout=function(){d.logout().then(function(){b.$broadcast(c.auth.logoutSuccess,event)},function(a){b.$broadcast(c.auth.logoutFailed,event,a)})}}])}(),function(){"use strict";var a=angular.module("fvApp");a.directive("fvOrderBox",function(){return{restrict:"E",scope:{offer:"@"},templateUrl:"views/directives/fv-order-box.html",link:function(a){a.priceDiscriminators=[{text:"500 words",value:10},{text:"700 words",value:12},{text:"1000 words",value:15}],a.addons=[{text:"Unlimited revisions",value:20},{text:"3 initial concepts",value:30},{text:"1 day delivery",value:30}]}}})}(),function(){"use strict";var a=angular.module("fvApp");a.directive("fvPortfolioViewer",["PortfolioSvc",function(a){var b=7;return{restrict:"E",scope:!0,templateUrl:"views/directives/fv-portfolio-viewer.html",link:function(c){c.portfolio=a.getPortfolio(),c.showcasePrev=function(){c.showcaseIndex>0&&(c.showcaseIndex-=1)},c.showcaseNext=function(){c.showcaseIndex<c.portfolio.items.length-1&&(c.showcaseIndex+=1)},c.goToShowcaseItem=function(a){c.showcaseIndex=a},c.$watch("showcaseIndex",function(a,d){a>=b&&a>d&&(c.galleryIndex+=1),a>0&&d>a&&(c.galleryIndex-=1)})}}}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("LocationSvc",["$q","$http","breeze","PATHS","Odata",function(a,b,c,d,e){function f(a){return _.map(a,function(a){return new e.Location(a)})}var g={},h=new c.DataService({serviceName:d.public,hasServerMetadata:!1}),i=new c.EntityManager({dataService:h});return g.searchCity=function(c,e){var g=a.defer(),h=[d.public,"CitiesByPrefix","?format=json","&countryID=",c,"&prefix=","'",e,"'","&$format=json","&$expand=Name/Literals"].join("");return b.get(h).then(function(a){console.log(a),g.resolve(f(a.data.value))},function(a){g.reject(a)}),g.promise},g.getCountries=function(){var b=a.defer(),d=new c.EntityQuery("CountriesLocations").expand("Name.Literals");return i.executeQuery(d).then(function(a){b.resolve(f(a.results[0].value))},function(a){console.log(a)}),b.promise},g}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("AccountSvc",["$q","$http","PATHS","MESSAGES","NotificationSvc",function(a,b,c,d,e){var f={};return f.register=function(a){return b.post(c.account.register,{Email:a.email,Password:a.password,ConfirmPassword:a.password,FirstName:a.firstName,LastName:a.lastName})},f.login=function(a){return b.post(c.account.login,{Email:a.email,Password:a.password,RememberMe:!0})},f.logout=function(){return b.post(c.account.logout,{})},f.forgotPassword=function(b){var c=a.defer();return c.resolve(b),c.promise},f.resetPassword=function(a){return b.post(c.account.resetPassword,a)},f.getUserInfo=function(){var d=a.defer();return b.get(c.account.userInfo).then(function(a){d.resolve({email:a.data.UserName,userID:a.data.UserID,authProvider:a.data.LoginProvider,hasRegistered:a.data.HasRegistered})},function(a){console.log(a),d.reject(a)}),d.promise},f.externalLogins=function(){return b.get(c.account.externalLogins)},f.externalLogin=function(a){f.externalLogins().then(function(b){window.location.replace(c.root+_.find(b.data,function(b){return b.Name===a}).Url)},function(a){console.log(a),e.show({content:d.error.generic,type:"error"})})},f}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("CatalogueSvc",["$http","$q","$timeout","breeze","PATHS",function(a,b,c,d,e){function f(a){return _.pluck(a.results[0].value,function(a){return{categoryID:a.ID,categoryName:a.Name.Literals[0].Text}})}function g(a){return _.pluck(a.results[0].value,function(a){return{serviceID:a.ID,shortTitle:a.ShortTitle.Literals[0].Text,thumbnail:{link:a.ThumbnailFile.Url}}})}function h(a){return a.results[0]["odata.count"]}function i(a){var b=a.results[0].value[0],c={serviceID:b.ID,title:b.Title&&b.Title.Literals[0].Text,shortTitle:b.ShortTitle&&b.ShortTitle.Literals[0].Text,description:b.Description&&b.Description.Literals[0].Text,deliverables:b.ExpectedDeliverables&&b.ExpectedDeliverables.Literals[0].Text,provision:b.BuyerProvision&&b.BuyerProvision.Literals[0].Text,options:b.Options,excluded:b.ExcludedServices&&b.ExcludedServices.Literals[0].Text,viewHint:b.ViewHint,thumbnail:{link:b.ThumbnailFile.Url},showcasePrompt:b.ShowcasePrompt&&b.ShowcasePrompt.Literals[0].Text};return c.allowedShowcaseFileTypes=_.pluck(b.AllowedShowcaseFileTypes,function(a){return a.Name&&a.Name.Literals[0].Text}),c.options=b.Options.map(function(a){return{isPriceDiscriminator:a.IsPriceDiscriminator,isMandatory:a.IsMandatory,isDaysDiscriminator:a.IsDaysDiscriminator,sellerTitle:a.SellerTitle&&a.SellerTitle.Literals[0].Text,choices:a.Choices.map(function(a){return{name:a.Name&&a.Name.Literals[0].Text,value:a.value}})}}),c.fields=b.Fields.map(function(a){return{allowedFileTypes:_.pluck(a.AllowedFileTypes,function(a){return a.Name&&a.Name.Literals[0].Text}),order:a.Order,isMandatory:a&&a.IsRequired?!0:!1,sellerLabel:a&&a.SellerLabel&&a.SellerLabel.Literals[0].Text}}),c.interview=_.find(c.fields,function(a){return 0===a.order}),_.remove(c.fields,function(a){return 0===a.order}),c}var j={},k=new d.DataService({serviceName:e.cached,hasServerMetadata:!1}),l=new d.EntityManager({dataService:k});return j.services=[],j.batch=16,j.getRootCategories=function(){var a=b.defer(),c=new d.EntityQuery("RootCategories").expand("Name.Literals");return l.executeQuery(c).then(function(b){var c=f(b);c.unshift({categoryID:null,categoryName:"All"}),a.resolve(c)},function(b){a.reject(b)}),a.promise},j.getService=function(a){var c=b.defer(),e=new d.EntityQuery("Services").where("ID","eq",a).expand(["Title.Literals","ShortTitle.Literals","Description.Literals","ThumbnailFile","ExpectedDeliverables.Literals","BuyerProvision.Literals","ExcludedServices.Literals","AllowedShowcaseFileTypes.Name.Literals","ShowcasePrompt.Literals","Fields","Fields.AllowedFileTypes.Name.Literals","Fields.AllowedFileTypes.MimeTypes","Fields.SellerLabel.Literals","Fields.Order","Options.SellerTitle.Literals","Options.Choices.Name.Literals"].join(", "));return l.executeQuery(e).then(function(a){console.log(a),c.resolve(i(a))},function(a){c.reject(a)}),c.promise},j.getServices=function(a){var c=b.defer(),e=new d.EntityQuery("Services").expand("ShortTitle.Literals, ThumbnailFile");return j.services.length>0&&c.resolve(j.services.slice(a,a+j.batch)),0===j.services.length&&l.executeQuery(e).then(function(b){j.services=g(b),c.resolve(j.services.slice(a,a+j.batch))},function(a){c.reject(a)}),c.promise},j.getServicesUnderCategory=function(a,c){var e=b.defer(),f=new d.EntityQuery("ServicesUnderCategory").withParameters({CategoryID:a}).skip(c).take(j.batch).expand("ShortTitle.Literals, ThumbnailFile").inlineCount();return l.executeQuery(f).then(function(a){e.resolve({services:g(a),totalCount:h(a)})},function(a){e.reject(a)}),e.promise},j}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("OfferSvc",["$http","$q","$timeout","Enum",function(a,b,c,d){var e={},f={},g=[];return e.Offer=function(){return{workSamples:[],status:d.OfferStatus.DRAFT,serviceID:"",choices:[],lowestPrice:""}},f=new e.Offer,e.setOffer=function(a){f=a},e.updateOffer=function(a){angular.extend(f,a)},e.addWorkSamples=function(a){a&&_.each(a,function(a){f.workSmaples.push(a)})},e.addOffer=function(a){var b=a||f;g.push(b)},e.removeOffer=function(a){var b=a||f.serviceID;g.remove(function(a){return a.serviceID===b})},e.getOffer=function(){return f},e.fetchOffer=function(a,d){a&&console.log(a,d);var e=b.defer();return c(function(){e.resolve(f)}),e.promise},e.fetchOffers=function(){for(var a=_.random(3,20),d={},f=0;a>f;f++)d=new e.Offer,angular.extend(d,{serviceID:1,lowestPrice:"$100"}),g.push(d);var h=b.defer();return c(function(){h.resolve(g)}),h.promise},e}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("ProfileSvc",["$http","$q","$upload","$timeout","IMPORT_PROVIDERS","PATHS","Utils","Odata",function(a,b,c,d,e,f,g,h){var i={},j=e,k=["import","info","service_selection","offer_config","storefront"],l="import",m=new h.SellerProfile;return i.Provider=function(a,b){this.name=a,this.url=b},i.initProviders=function(){var a={};return _.forEach(j,function(b){a[b]=new i.Provider(b,"")}),a},i.getActiveStep=function(){return l},i.getProfile=function(){return m},i.getSteps=function(){return k},i.setActiveStep=function(a){l=a},i.updateProfile=function(a){g.updateProperties(m,a)},i.createProfile=function(b){return console.log(JSON.stringify(b)),a.post(f.sellerManagement.ownProfile,b)},i.patchProfile=function(b){return a({method:"PATCH",url:f.sellerManagement.ownProfile,data:b})},i.fetchOwnProfile=function(){var c=b.defer();return a.get(f.sellerManagement.ownProfile+"?expand=User, Title/Literals, Description/Literals").then(function(a){console.log(a),g.updateProperties(m,a.data),c.resolve(m)},function(a){c.reject(a)}),c.promise},i.fetchProfile=function(c){var d=b.defer();return a.get(f.sellerManagement.profile+c).then(function(a){console.log(a),g.updateProperties(m,a.data),d.resolve(m)},function(a){d.reject(a)}),d.promise},i.fetchProfileStatus=function(){var c=b.defer();return a.get(f.sellerManagement.profileStatus).then(function(a){a&&"null"!==a.data?c.resolve():c.reject()},function(a){console.log(a)}),c.promise},i.validateMoniker=function(b){return a.get(f.sellerManagement.monikerExists(b))},i}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("ImporterSvc",["$rootScope","$http","$q","$timeout","$interval","PATHS","IMPORT_PROVIDERS","EVENTS","MESSAGES","Odata",function(a,b,c,d,e,f,g,h,i,j){function k(a){if(a){var b=[];switch(null!==a.Profile&&2===a.Profile&&b.push("profile"),null!==a.Reviews&&2===a.Reviews&&b.push("reviews"),null!==a.Portfolio&&2===a.Portfolio.CurrentStatus&&b.push("portfolio"),b.length){case 0:return["none"];case 3:return["all"];default:return b}}}function l(b,c){var e;switch(b){case"profile":e=h.importer.profileReady;break;case"portfolios":e=h.importer.portfoliosReady;break;case"reviews":e=h.importer.reviewsReady}d(function(){a.$broadcast(e,c)})}function m(){b.post(f.importer.checkProgress,t.capitalize()).then(function(a){var b,c;_.each(a.data,function(a){if(b=_.pluck(t.importers,"guid").indexOf(a.Guid),c=b>-1?t.importers[b]:null,c&&-1===k(a).indexOf("none")){if(k(a).indexOf("all")>-1&&(0===p.importers.length||-1===p.importers.indexOf(c)))return-1===p.importers.indexOf(c)&&p.importers.push(c),t.importers.splice(b,1),l("profile",c),l("portfolios",c),void l("reviews",c);k(a).indexOf("profile")>-1&&(0===q.importers.length||-1===q.importers.indexOf(c))&&(q.importers.push(c),l("profile",c)),k(a).indexOf("portfolio")>-1&&(0===s.importers.length||-1===s.importers.indexOf(c))&&(s.importers.push(c),l("portfolios",c)),k(a).indexOf("reviews")>-1&&(0===r.importers.length||-1===r.importers.indexOf(c))&&(r.importers.push(c),l("reviews",c)),0===t.importers.length&&v()}})},function(a){console.log(a)})}function n(a){return _.map(a.data,function(a){return new y.Importer(a)})}var o,p,q,r,s,t,u,v,w,x=[],y={};return v=function(){e.cancel(u)},w=function(){m(),u=e(function(){t.getImporters().length>0?m():v()},6e3,100,!1)},y.Importer=function(a){this.provider=a.Provider||"",this.url=a.Url||"",this.guid=a.Guid||""},y.Importer.prototype.capitalize=function(){return{Provider:this.provider,Url:this.url,Guid:this.guid}},y.ImporterCollection=function(){this.importers=[]},y.ImporterCollection.prototype.getImporters=function(){return this.importers},y.ImporterCollection.prototype.setImporters=function(a){this.importers=a},y.ImporterCollection.prototype.addImporters=function(a){this.importers.merge(a)},y.ImporterCollection.prototype.capitalize=function(){return _.map(this.importers,function(a){return a.capitalize()})},y.getImporters=function(a){switch(a){case"inProgress":return t.getImporters();case"done":return p.getImporters();case"profileDone":return q.getImporters();case"portfoliosDone":return s.getImporters();default:return o.getImporters()}},y.import=function(a){var d=c.defer();return b.post(f.importer.import,a).then(function(a){t.addImporters(n(a)),!angular.isDefined(u)&&w()},function(a){console.log(a)}),d.promise},y.fetchProfile=function(){var a=c.defer();return 0===q.length&&a.reject(i.error.profileImportFailed),q.length>0&&b.post(f.importer.fetchProfile,q.capitalize()).then(function(b){a.resolve(new j.SellerProfile(b.data[0].data.response.data.PersonalInfo))},function(b){console.log(b),a.reject(b)}),a.promise},y.fetchPortfolios=function(){var a=c.defer();return s&&s.importers.length>0&&b.post(f.importer.fetchPortfolios,s.importers).then(function(b){console.log(b),a.resolve(x)},function(b){console.log(b),a.reject(b)}),a.promise},a.$on(h.auth.sessionTimeout,function(){v()}),o=new y.ImporterCollection,p=new y.ImporterCollection,t=new y.ImporterCollection,q=new y.ImporterCollection,r=new y.ImporterCollection,s=new y.ImporterCollection,_.each(g,function(a){o.importers.push(new y.Importer({Provider:a}))}),y}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("UserSvc",["$rootScope","$http","$q","PATHS","EVENTS","Odata",function(a,b,c,d,e,f){var g={};return g.fetchUser=function(){var g=c.defer();return b.get(d.user.self).then(function(b){var c=new f.User(b.data);a.$broadcast(e.user.updateSuccess,c),g.resolve(c)},function(a){g.reject(a)}),g.promise},g}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("PortfolioSvc",["$http","$q","$timeout",function(a,b,c){var d={},e={};return d.updatePortfolio=function(a){angular.extend(e,a)},d.getPortfolio=function(){return e},d.fetchPortfolio=function(a,d,e){console.log(a,d,e);for(var f=function(){return{title:"Logo Design",url:"http://www.accusoft.com/html5viewer/img/btn-file-icon-ppt-sm.png",name:"btn-file-icon-ppt-sm.png"}},g=_.random(3,20),h=[],i=0;g>i;i++)h.push(new f);var j=b.defer();return c(function(){j.resolve({items:h})}),j.promise},d}])}();