!function(){"use strict";var a=angular.module("fvApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","mgcrea.ngStrap","mgcrea.ngStrap.modal","mgcrea.ngStrap.helpers.dimensions","mgcrea.ngStrap.helpers.parseOptions","mgcrea.ngStrap.tooltip","mgcrea.ngStrap.select","mgcrea.ngStrap.tab","mgcrea.ngStrap.collapse","mgcrea.ngStrap.button","mgcrea.ngStrap.alert","mgcrea.ngStrap.typeahead","config","angularFileUpload","ngImgCrop","duScroll","angular-carousel","ui.validate","breeze.angular","angucomplete","angularMoment","config"]);a.config(["$routeProvider",function(a){a.when("/register",{templateUrl:"views/register.html",controller:"RegistrationCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/forgotPassword",{templateUrl:"views/forgotPassword.html",controller:"ForgotPwdCtrl"}).when("/resetPassword",{templateUrl:"views/resetPassword.html",controller:"ResetPwdCtrl"}).when("/apply",{templateUrl:"views/apply.html",controller:"ApplyCtrl"}).when("/:moniker",{templateUrl:"views/storefront.html",controller:"StorefrontCtrl",resolve:{profile:["$route","$location","$q","ProfileSvc",function(a,b,c,d){var e=c.defer();return d.fetchProfile(a.current.params.moniker).then(function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise}]}}).when("/offers/:offerId",{templateUrl:"views/offer.html",controller:"OfferCtrl",resolve:{offer:["$route","OfferSvc",function(a,b){return b.fetchOffer(a.current.params.offerId)}]}}).otherwise({templateUrl:"views/landing.html",controller:"LandingCtrl"})}]),a.value("duScrollGreedy",!0),a.config(["$alertProvider","$httpProvider",function(a,b){b.defaults.withCredentials=!0,b.defaults.useXDomain=!0,delete b.defaults.headers.common["X-Requested-With"],b.responseInterceptors.push(["$rootScope","$q","$location","PATHS","ENV","MESSAGES","EVENTS",function(a,b,c,d,e,f,g){return function(f){return f.then(function(a){return a},function(f){return 401===f.status?(console.log(f),f.config.url!==e.api.endPoint+d.account.userInfo&&(a.$broadcast(g.auth.sessionTimeout,f),c.path("/login")),f):b.reject(f)})}}]),angular.extend(a.defaults,{animation:"am-fade-and-slide-top",placement:"top",duration:4,dismissable:!0,template:"views/components/alert.html"})}]),a.run(["breeze",function(a){!a&&console.log("breeze not loaded!")}])}(),function(){"use strict";angular.module("config",[]).constant("ENV",{name:"production",api:{endPoint:"https://futurventionstage.azurewebsites.net",hostedFiles:"https://ergmaimages.blob.core.windows.net/stageuserdata/",externalLogins:"https://futurventionstage.azurewebsites.net/api/Account/ExternalLogins?returnUrl=https://futurventionclient.azurewebsites.net&generateState=true"},fbApiKey:"675990215825778",liApiKey:"77xj8xhasosg9k"})}(),function(){"use strict";var a=angular.module("fvApp");a.constant("EVENTS",{profile:{fetchProfileFailed:"fetch-profile-failed",fetchProfileSuccess:"fetch-profile-success",profileUpdated:"profile-updated"},user:{createSuccess:"user-creation-success",createFailed:"user-creation-failed",updateSuccess:"user-update-success",updateFailed:"user-update-failed"},auth:{registrationSuccess:"auth-registration-success",registrationFailed:"auth-registration-failed",loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"},importer:{portfoliosReady:"imp-portfolios-ready",reviewsReady:"imp-reviews-ready",polling:{start:"imp-polling-start",profileImported:"imp-profile-imported",statusUpdated:"imp-status-updated",end:"imp-polling-end"}},ui:{providerSelected:"ui-provider-selected",cameraReady:"ui-camera-ready",loaderClosed:"ui-loader-closed",alertClosed:"ui-alert-closed"}}),a.constant("USER_ROLES",{all:"*",admin:"admin",user:"user",guest:"guest"}),a.constant("PATHS",{"public":"/public.svc/",cached:"/CachedPublic.svc/",account:{register:"/api/Account/Register",login:"/api/Account/Login",logout:"/api/Account/Logout",userInfo:"/api/Account/UserInfo",resetPassword:"/api/Account/ChangePassword"},importer:{importedData:"https://extservicesdata.blob.core.windows.net/crawleddata/","import":"/api/ExtService/import",checkProgress:"/api/ExtService/checkprogress",fetchProfile:"/api/ExtService/getprofiles",fetchPortfolios:"/api/ExtService/getportfolios"},sellerManagement:{profile:"/api/SellerManagement/Profiles/",ownProfile:"/api/SellerManagement/Profiles/OwnProfile",ownShowcase:"/api/SellerManagement/Profiles/OwnProfile/Showcases",profileStatus:"/api/SellerManagement/Profiles/OwnProfile/Status",importedShowcases:"/api/SellerManagement/Profiles/OwnProfile/ImportedShowcases?serviceID=",showcases:"/api/SellerManagement/SellerProfiles/OwnProfile/SingleItemShowcases?serviceID=",ownReviews:"/api/SellerManagement/Profiles/OwnProfile/reviews",monikerExists:function(a){return["/api/SellerManagement/Profiles/",a,"/exists"].join("")}},user:{self:"/api/Self?expand=Avatar",ownAvatar:"/api/Self/Avatar"},file:{imported:"https://extservicesdata.blob.core.windows.net:443/crawleddata/"},offerManagement:{ownOffers:"/api/OffersManagement/OwnOffers",offeredServices:"/api/OffersManagement/OwnOffers?expand=Service/ShortTitle/Literals,Service/ThumbnailFile"}}),a.constant("ROUTES",{"public":["/","/login","/register","/forgotPassword","/resetPassword"]}),a.constant("MESSAGES",{error:{generic:"An error has occured. Please try again later.",logoutFailed:"Something went wrong. Please try logging out again.",profileImportFailed:"No profiles could be imported",portfoliosImportFailed:"No portfolios could be imported at this time.",profileSaveFailed:"Something went wrong! Please try saving your profiles again.",wrongCredentials:"Wrong email or password",wrongEmailFormat:"The email you entered is incorrect.",wrongPassword:"The password you entered is incorrect.",emailTaken:"The email you entered is already taken",importProfileTimeout:"There was a problem importing your profile information. You can still create your profile manually.",saveAvatarFailed:"There was a problem importing your avatar. You can still upload one manually.",invalidFileType:"Invalid file type."},success:{createNewPassword:"We sent you an email. Follow the instructions to create a new password.",resetPassword:"Your password has been reset!",profileImported:"Your profile has been imported from ",showcaseDeleteSuccess:"Successfully deleted "},warning:{tooLong:"This is taking longer than expected..."}}),a.constant("IMPORT_PROVIDERS",["linkedin","odesk","elance","pph","behance","dribbble","github"]),a.constant("PROVIDERS_ENUM",{behance:1,dribbble:2,elance:3,github:5,odesk:6,peopleperhour:7}),a.constant("SELLER_PROFILE_STATUS_ENUM",{"new":0,importing:1,settingProfileFields:2,creatingOffers:3,ready:4,inactive:5}),a.constant("FILE_TYPE_CONFIG",[{ID:1,ContentCode:"image/x-jg",Viewer:"Prizma",Thumbnail:"General"},{ID:2,ContentCode:"video/avs-video",Viewer:"Html5 video",Thumbnail:"General"},{ID:3,ContentCode:"image/bmp",Viewer:"Html5 image",Thumbnail:"General"},{ID:4,ContentCode:"text/csv",Viewer:"Prizma",Thumbnail:"Excel"},{ID:5,ContentCode:"application/x-director",Viewer:"Prizma",Thumbnail:"General"},{ID:6,ContentCode:"video/x-dv",Viewer:"Html5 video",Thumbnail:"General"},{ID:7,ContentCode:"application/msword",Viewer:"Prizma",Thumbnail:"Word"},{ID:8,ContentCode:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",Viewer:"Prizma",Thumbnail:"Word"},{ID:9,ContentCode:"image/vnd.dwg",Viewer:"Prizma",Thumbnail:"General"},{ID:10,ContentCode:"image/vnd.dxf",Viewer:"Prizma",Thumbnail:"General"},{ID:11,ContentCode:"message/rfc822",Viewer:"Prizma",Thumbnail:"General"},{ID:12,ContentCode:"application/postscript",Viewer:"Prizma",Thumbnail:"General"},{ID:13,ContentCode:"video/x-atomic3d-feature",Viewer:"Html5 video",Thumbnail:"General"},{ID:14,ContentCode:"image/g3fax",Viewer:"Prizma",Thumbnail:"General"},{ID:15,ContentCode:"image/gif",Viewer:"Html5 image",Thumbnail:"General"},{ID:16,ContentCode:"text/html",Viewer:"Prizma",Thumbnail:"General"},{ID:17,ContentCode:"image/x-icon",Viewer:"Prizma",Thumbnail:"General"},{ID:18,ContentCode:"image/jpeg",Viewer:"Html5 image",Thumbnail:"General"},{ID:19,ContentCode:"image/vnd.fujixerox.edmics-mmr",Viewer:"Prizma",Thumbnail:"General"},{ID:20,ContentCode:"audio/mpeg3",Viewer:"Html5 audio",Thumbnail:"General"},{ID:21,ContentCode:"application/mp4",Viewer:"Html5 video",Thumbnail:"General"},{ID:22,ContentCode:"application/vnd.mophun.certificate",Viewer:"Prizma",Thumbnail:"General"},{ID:23,ContentCode:"application/vnd.mobius.msl",Viewer:"Prizma",Thumbnail:"General"},{ID:24,ContentCode:"application/vnd.oasis.opendocument.graphics",Viewer:"Prizma",Thumbnail:"General"},{ID:25,ContentCode:"application/vnd.oasis.opendocument.presentation",Viewer:"Prizma",Thumbnail:"General"},{ID:26,ContentCode:"application/vnd.oasis.opendocument.spreadsheet",Viewer:"Prizma",Thumbnail:"Excel"},{ID:27,ContentCode:"application/vnd.oasis.opendocument.text",Viewer:"Prizma",Thumbnail:"Txt"},{ID:28,ContentCode:"application/vnd.oasis.opendocument.graphics-template",Viewer:"Prizma",Thumbnail:"General"},{ID:29,ContentCode:"application/vnd.oasis.opendocument.text-template",Viewer:"Prizma",Thumbnail:"General"},{ID:30,ContentCode:"image/x-pict",Viewer:"Prizma",Thumbnail:"General"},{ID:31,ContentCode:"image/x-pcx",Viewer:"Prizma",Thumbnail:"General"},{ID:32,ContentCode:"application/vnd.palm",Viewer:"Prizma",Thumbnail:"General"},{ID:33,ContentCode:"application/pdf",Viewer:"Prizma",Thumbnail:"PDF"},{ID:34,ContentCode:"application/x-font-type1",Viewer:"Prizma",Thumbnail:"General"},{ID:35,ContentCode:"image/x-portable-graymap",Viewer:"Prizma",Thumbnail:"General"},{ID:36,ContentCode:"image/pict",Viewer:"Prizma",Thumbnail:"General"},{ID:37,ContentCode:"image/png",Viewer:"Html5 image",Thumbnail:"General"},{ID:38,ContentCode:"image/x-portable-anymap",Viewer:"Prizma",Thumbnail:"General"},{ID:39,ContentCode:"image/x-portable-pixmap",Viewer:"Prizma",Thumbnail:"General"},{ID:40,ContentCode:"application/vnd.ms-powerpoint",Viewer:"Prizma",Thumbnail:"PowerPoint"},{ID:41,ContentCode:"application/vnd.openxmlformats-officedocument.presentationml.presentation",Viewer:"Prizma",Thumbnail:"General"},{ID:42,ContentCode:"image/vnd.adobe.photoshop",Viewer:"Prizma",Thumbnail:"General"},{ID:43,ContentCode:"image/x-cmu-raster",Viewer:"Prizma",Thumbnail:"General"},{ID:44,ContentCode:"image/x-rgb",Viewer:"Prizma",Thumbnail:"General"},{ID:45,ContentCode:"application/rtf",Viewer:"Prizma",Thumbnail:"Txt"},{ID:46,ContentCode:"application/vnd.stardivision.draw",Viewer:"Prizma",Thumbnail:"General"},{ID:47,ContentCode:"application/vnd.stardivision.calc",Viewer:"Prizma",Thumbnail:"Excel"},{ID:48,ContentCode:"application/vnd.stardivision.impress",Viewer:"Prizma",Thumbnail:"General"},{ID:49,ContentCode:"application/vnd.stardivision.writer",Viewer:"Prizma",Thumbnail:"General"},{ID:50,ContentCode:"application/vnd.sun.xml.calc.template",Viewer:"Prizma",Thumbnail:"Excel"},{ID:51,ContentCode:"application/vnd.sun.xml.draw.template",Viewer:"Prizma",Thumbnail:"General"},{ID:52,ContentCode:"application/vnd.sun.xml.impress.template",Viewer:"Prizma",Thumbnail:"General"},{ID:53,ContentCode:"application/step",Viewer:"Prizma",Thumbnail:"General"},{ID:54,ContentCode:"application/vnd.sun.xml.writer.template",Viewer:"Prizma",Thumbnail:"General"},{ID:55,ContentCode:"image/svg+xml",Viewer:"Prizma",Thumbnail:"General"},{ID:56,ContentCode:"application/x-shockwave-flash",Viewer:"Html5 video",Thumbnail:"General"},{ID:57,ContentCode:"application/vnd.sun.xml.calc",Viewer:"Prizma",Thumbnail:"Excel"},{ID:58,ContentCode:"application/vnd.sun.xml.draw",Viewer:"Prizma",Thumbnail:"General"},{ID:59,ContentCode:"application/vnd.sun.xml.impress",Viewer:"Prizma",Thumbnail:"General"},{ID:60,ContentCode:"application/vnd.sun.xml.writer",Viewer:"Prizma",Thumbnail:"General"},{ID:61,ContentCode:"image/tiff",Viewer:"Prizma",Thumbnail:"General"},{ID:62,ContentCode:"application/x-font-ttf",Viewer:"Prizma",Thumbnail:"General"},{ID:63,ContentCode:"text/plain",Viewer:"Prizma",Thumbnail:"Txt"},{ID:64,ContentCode:"text/x-uil",Viewer:"Prizma",Thumbnail:"General"},{ID:65,ContentCode:"image/vnd.wap.wbmp",Viewer:"Prizma",Thumbnail:"General"},{ID:66,ContentCode:"application/x-msmetafile",Viewer:"Prizma",Thumbnail:"General"},{ID:67,ContentCode:"image/x-xbitmap",Viewer:"Prizma",Thumbnail:"General"},{ID:68,ContentCode:"application/xhtml+xml",Viewer:"Prizma",Thumbnail:"General"},{ID:69,ContentCode:"application/vnd.ms-excel",Viewer:"Prizma",Thumbnail:"Excel"},{ID:70,ContentCode:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",Viewer:"Prizma",Thumbnail:"Excel"},{ID:71,ContentCode:"application/excel",Viewer:"Prizma",Thumbnail:"Excel"},{ID:72,ContentCode:"application/xml",Viewer:"Prizma",Thumbnail:"General"},{ID:73,ContentCode:"image/x-xpixmap",Viewer:"Prizma",Thumbnail:"General"},{ID:74,ContentCode:"image/x-xwindowdump",Viewer:"Prizma",Thumbnail:"General"},{ID:75,ContentCode:"application/prezi",Viewer:"Prizma",Thumbnail:"General"}])}(),function(){"use strict";var a=angular.module("fvApp");a.directive("fvSlider",["$document","$timeout",function(a,b){var c=40,d=38;return{restrict:"E",templateUrl:"views/directives/fv-slider.html",link:function(e,f,g){function h(a){b(function(){"up"===e.direction?e.index++:e.index--},l*a)}function i(){return function(a){var b=window.event||a,c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail));return e.$apply(e.goToSlide(0>c?e.index+1:e.index-1)),!1}}function j(a){a.keyCode===c&&e.$apply(function(){e.goToSlide(e.index+1)}),a.keyCode===d&&e.$apply(function(){e.goToSlide(e.index-1)})}var k=600,l=200,m=!1;g.fullscreen&&angular.element("body").css("overflow","hidden"),e.options={fullscreen:g.fullscreen,keyboard:g.keyboard,count:g.count||0,slidename:g.slidename||"slide",indicator:g.indicator,navbtn:g.navbtn},e.slides=[];for(var n=0;n<g.count;n++)e.slides.push(g.slidename+n);e.index=0,e.direction="up",e.speed=800,e.goToSlide=function(a){var c=0;if(!(m||0>a||a===e.slides.length)){m=!0,b(function(){m=!1},1e3,!1),e.direction=e.index>a?"down":"up",c=Math.abs(e.index-a),e.speed=k-(c-1)*l;for(var d=0;c>d;d++)h(d)}},angular.element(a).on("keydown",j),document.addEventListener&&(document.addEventListener("mousewheel",i(),!1),document.addEventListener("DOMMouseScroll",i(),!1)),e.$on("$destroy",function(){g.fullscreen&&angular.element("body").css("overflow","auto"),angular.element(a).off("keydown"),angular.element(a).off("mousewheel"),angular.element(a).off("DOMMouseScroll")})}}}]),a.directive("fvScrollBottom",["$window","$document","$timeout",function(a,b,c){return{restrict:"A",link:function(d,e,f){d.$on(f.scrolltrigger,function(){c(function(){a.scrollTo(0,angular.element(b)[0].body.scrollHeight)})})}}}]),a.directive("fvScrollTo",["$document","$timeout",function(a,b){return{restrict:"A",link:function(c,d,e){b(e.fvScrollTo&&a.scrollToElement(d))}}}]),a.directive("fvAutoFocus",["$timeout",function(a){return{restrict:"A",link:function(b,c){c&&c.focus&&a(function(){c.focus()})}}}]),a.directive("fvFocusInput",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){var b=document.getElementsByName(d.focusInput)[0];b&&c.on(d.focusOn,function(){a(function(){b.focus()})})})}}}]),a.directive("fvBgImage",function(){return{restrict:"A",link:function(a,b,c){c.$observe("fvBgImage",function(a,c){a&&a!==c&&b.css("background-image",['url("',a,'")'].join(""))},!0)}}}),a.directive("fvDraggable",function(){return function(a,b,c){var d=b[0];return c.fvDraggable===!1?void d.removeAttr("draggable"):(d.draggable=!0,void d.addEventListener("dragstart",function(a){return a.dataTransfer.effectAllowed="move",c.fvData&&a.dataTransfer.setData("Text",JSON.stringify(c.fvData)),!1},!1))}}),a.directive("fvDroppable",function(){return{scope:{},link:function(a,b,c){var d=b[0];c.fvDropClass&&d.addEventListener("dragenter",function(){return this.classList.add(c.fvDropClass),!1},!1),c.fvDropClass&&d.addEventListener("dragleave",function(){return this.classList.remove(c.fvDropClass),!1},!1),d.addEventListener("dragover",function(a){return a.preventDefault&&a.preventDefault(),a.dataTransfer.dropEffect="move",!1},!1),d.addEventListener("drop",function(a){return a.stopPropagation&&a.stopPropagation(),c.fvDropClass&&this.classList.remove(c.fvDropClass),!1},!1)}}}),a.directive("fvOnDrop",function(){return{restrict:"A",link:function(a,b,c){b[0].addEventListener("drop",function(b){a.$apply(_.bind(a[c.fvOnDrop],{event:b},a.item))})}}}),a.directive("fvTimelineH",["$location","ProfileSvc",function(a,b){return{restrict:"E",scope:{activeStep:"=",goToStep:"&",currentUser:"="},templateUrl:"views/directives/fv-timeline-h.html",link:function(c){var d=["import","info","service_selection","offer_config","storefront"];c.navigateTo=function(e){switch(!0){case 3===e:c.currentUser&&c.currentUser.Profile&&c.currentUser.Profile.Moniker&&a.path("/"+c.currentUser.Profile.Moniker);break;case"/apply"===a.path()&&2>e:c.$parent.goToStep(e);break;case"/apply"===a.path()&&2===e:c.currentUser&&c.currentUser.Profile&&c.currentUser.Profile.Moniker&&c.$parent.goToStep(e);break;default:b.setActiveStep(d[e]),a.path("/apply")}}}}}]),a.directive("fvDynamicName",["$compile","$parse",function(a,b){return{restrict:"A",terminal:!0,priority:1e5,link:function(c,d){var e=b(d.attr("fv-dynamic-name"))(c);d.removeAttr("fv-dynamic-name"),d.attr("name",["input","-",e].join("")),a(d)(c)}}}]),a.directive("fvToggleClass",function(){return function(a,b,c){c.fvOn&&c.fvClass&&b[0].addEventListener(c.fvOn,function(){this.classList.toggle(c.fvClass)})}}),a.directive("fvTabs",function(){return function(a,b){var c=_.filter(b.children(),function(a){return a.hasAttribute("fv-pane")});_.forEach(c,function(b,c){b.addEventListener("click",function(){a.$emit("pane-clicked",c)})}),a.$on("pane-clicked",function(a,b){_.forEach(c,function(a,c){b===c?angular.element(a).addClass("active"):angular.element(a).removeClass("active")})})}}),a.directive("fvCameraTag",["EVENTS",function(a){return{scope:{fvCameraTag:"@"},link:function(b){b.$emit(a.ui.cameraReady)}}}]),a.directive("fvAlert",["$rootScope","EVENTS",function(a,b){return{link:function(c){c.dismissAlert=_.throttle(function(){c.$hide(),a.$broadcast(b.ui.alertClosed)},1e3)}}}]),a.directive("fvCaption",function(){return{link:function(a,b){var c,d;c=angular.element(b.parent()),d=angular.element(b.parent().find("svg")),b.bind("focus",function(){c.css("border","1px solid lightgrey"),d.css("opacity","0")}),b.bind("blur",function(){c.css("border","0")}),c.bind("mouseenter",function(){d.css("opacity","1")}),c.bind("mouseleave",function(){d.css("opacity","0")}),a.$on("$destroy",function(){b.unbind(),c.unbind(),d.unbind()})}}})}(),function(){"use strict";var a=angular.module("fvApp");a.service("MessagingSvc",["$http","$q","$timeout",function(a,b,c){var d={};return d.sendMessage=function(a,d,e,f,g){console.log(g);var h=b.defer();return c(function(){h.resolve(g)}),h.promise},d}]),a.service("NotificationSvc",["$http","$q","$alert",function(a,b,c){var d={};return d.show=function(a){var d=c(a),e=b.defer();return e.resolve(d),e.promise},d}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("Enum",function(){var a={};return a.OfferStatus=Object.freeze({AUDIO:"audio",IMAGE:"image",INLINE_TEXT:"inline_text",TEXT:"text",VIDEO:"video"}),a.ShowcaseFileType=Object.freeze({LINKED:"linked",HOSTED:"hosted"}),a.Providers=Object.freeze({LINKEDIN:"linkedIn",ODESK:"oDesk",ELANCE:"elance",PPH:"pph",FREELANCER:"freelancer",BEHANCE:"behance",DRIBBBLE:"dribbble",GITHUB:"github"}),a})}(),function(){"use strict";var a=angular.module("fvApp");a.service("Utils",function(){var a={};return a.updateProperties=function(a,b,c){return b&&_.forOwn(a,function(d,e){b.hasOwnProperty(e)&&(a[e]="boolean"==typeof c&&c===!1?b[e]?b[e]:a[e]:b[e])}),a},a.removeEmptyProperties=function(a){var b,c,d;return _.pick(a,function(a){return b=typeof a===Number&&0===a,c=null===a,d=a instanceof Array&&0===a.length,!b&&!c&&!d})},a.getCameraTagUuid=function(a){return a.replace("http://cameratag.com/videos/","").replace("/qvga/mp4.mp4","")},a.capitalize=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},a.capitalizeKeys=function(b){var c={},d=_.values(b);return _.each(_.keys(b),function(b,e){c[a.capitalize(b)]=d[e]}),c},a.camelCaseKeys=function(b){if(_.isObject(b)){var c={},d=_.values(b);return _.each(_.keys(b),function(e,f){/[a-z]/.test(e)?c[e.charAt(0).toLowerCase()+e.slice(1)]=_.isObject(b[e])?a.camelCaseKeys(d[f]):d[f]:c[e]=d[f]}),c}},a.base64toBlob=function(a,b){b=b||"";for(var c=1024,d=atob(a),e=d.length,f=Math.ceil(e/c),g=new Array(f),h=0;f>h;++h){for(var i=h*c,j=Math.min(i+c,e),k=new Array(j-i),l=i,m=0;j>l;++m,++l)k[m]=d[l].charCodeAt(0);g[h]=new Uint8Array(k)}return new Blob(g,{type:b})},a.URL_PATTERN=/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#!\(\)-]*[\w@?^=%&amp;\/~+#-])?/gim,a.PSEUDO_URL_PATTERN=/(^|[^\/])(www\.[\S]+(\b|$))/gim,a.ELANCE_URL_PATTERN=/^https:\/\/(www\.elance\.com\/s\/.)/i,a.BEHANCE_URL_PATTERN=/^https:\/\/(www\.behance\.net\/.)/i,a.DRIBBBLE_URL_PATTERN=/^https:\/\/(dribbble\.com\/.)/i,a.GITHUB_URL_PATTERN=/^http:\/\/((www\.)?github\.com\/.)/i,a.ODESK_URL_PATTERN=/^https:\/\/(www\.odesk\.com\/users\/)(.+)(\_\~)(.+)/i,a.PEOPLEPERHOUR_URL_PATTERN=/^http:\/\/(www\.peopleperhour\.com\/freelancer\/(.+[\/])(.))/i,a.isVideo=function(a){var b=new RegExp(/video\/*/g);return b.test(a)},a.isImage=function(a){var b=new RegExp(/image\/*/g);return b.test(a)},a.getUrlParams=function(a){var b,c;if(a){for(var d=0;d<a.length;++d)c=a[d].split("=",2),b[c[0]]=1===c.length?"":decodeURIComponent(c[1].replace(/\+/g," "));return b}},a.testEmailPattern=function(a){return/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/im.test(a)},a.removeParenthesis=function(a){return a&&"string"==typeof a?a.replace(/ *\([^)]*\) */g,""):a},a.matchUrlPattern=function(b){return b?b.match(a.URL_PATTERN)||b.match(a.PSEUDO_URL_PATTERN):!1},a.matchProviderUrlPattern=function(b,c){if(b&&"string"==typeof b&&c&&"string"==typeof c)switch(c){case"elance":return b.match(a.ELANCE_URL_PATTERN);case"behance":return b.match(a.BEHANCE_URL_PATTERN);case"dribbble":return b.match(a.DRIBBBLE_URL_PATTERN);case"github":return b.match(a.GITHUB_URL_PATTERN);case"odesk":return b.match(a.ODESK_URL_PATTERN);case"peopleperhour":return b.match(a.PEOPLEPERHOUR_URL_PATTERN);default:return}},a.matchEngAndNum=function(a){return/^[a-z]+[a-z0-9]*$/gi.test(a)},a}),Array.prototype.hasOwnProperty("swap")||(Array.prototype.swap=function(a,b){var c=this[a];return this[a]=this[b],this[b]=c,this}),Array.prototype.hasOwnProperty("empty")||(Array.prototype.empty=function(){for(;this.length>0;)this.pop()}),Array.prototype.hasOwnProperty("remove")||(Array.prototype.remove=function(a){if("function"!=typeof a)return void 0;for(var b=0;b<this.length;b++)if(a(this[b]))return this.splice(b,1);return void 0}),Array.prototype.hasOwnProperty("merge")||(Array.prototype.merge=function(a){if(!(a instanceof Array))return void 0;for(var b=0;b<a.length;b++)this.push(a[b]);return this}),Function.prototype.hasOwnProperty("method")||(Function.prototype.method=function(a,b){return this.prototype[a]=b,this}),Function.prototype.hasOwnProperty("inherits")||Function.method("inherits",function(a){return this.prototype=new a,this.prototype.constructor=parent,this}),Function.prototype.hasOwnProperty("inheritFunctions")||(Function.prototype.inheritFunctions=function(a,b){if(a&&b&&a instanceof Object&&b instanceof Array){for(var c,d=this,e=0;e<b.length;e++)c=b[e],a.hasOwnProperty(c)&&a[c]instanceof Function&&(d.prototype[c]=a[c]);return d}})}(),function(){"use strict";var a=angular.module("fvApp");a.filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),a.filter("prizmUrl",function(){return function(a){return["http://connect.ajaxdocumentviewer.com/?key=K4102014161530&viewertype=html5&document=",a,"&viewerheight=100%&viewerwidth=100%&printButton=Yes&toolbarColor=CCCCCC"].join("")}}),a.filter("initial",function(){return function(a){return a.charAt(0).concat(".")}}),a.filter("getProviderName",["PROVIDERS_ENUM",function(a){return function(b){return _.findKey(a,function(a){return parseInt(b.Provider)===a})}}]),a.filter("beautifyProviderNames",function(){return function(a){switch(a){case"elance":return"Elance";case"behance":return"Behance";case"dribbble":return"Dribbble";case"github":return"Github";case"odesk":return"oDesk";case"peopleperhour":return"PeoplePerHour";default:return}}}),a.filter("displayMediaTypes",function(){return function(a){return a.join(", ").toLowerCase()}}),a.filter("importedLink",["PATHS","ENV",function(a,b){return function(c,d){return[b.api.endPoint+a.file.imported,d,"/",c.Provider,"/",c.FolderName,"/",c.ThumbnailAsset.Folder,"/",c.ThumbnailAsset.Name].join("")}}]),a.filter("notOffered",function(){return function(a,b){var c=[];if(a&&0!==a.length)return _.each(b,function(a){a.hasOwnProperty("ServiceID")&&c.push(a.ServiceID)}),_.filter(a,function(a){return-1===c.indexOf(a.serviceID)})}}),a.filter("invalidFileType",function(){return function(a,b){return[a,"could not be uploaded. File type",b.split("'")[1],"is not supported by the service."].join(" ")}})}(),function(){"use strict";var a=angular.module("fvApp");a.factory("Odata",["PROVIDERS_ENUM","PATHS","ENV","Utils",function(a,b,c,d){var e={},f={};return f.setMultilingual=function(a,b){var c=this;switch(!0){case!b||!c.hasOwnProperty(a):break;case null===c[a]:c[a]=new e.Multilingual({Literals:[new e.Literal({Text:b})]});break;case c[a]instanceof e.Multilingual:c[a].Literals[0].Text=b;break;case c[a].hasOwnProperty("Literals")&&c[a].Literals[0].hasOwnProperty("Text"):c[a].Literals[0].Text=b}return c},f.multilingualToString=function(a){return a&&-1!==_.keys(this,a).indexOf(a)?this[a].Literals[0].Text:void 0},e.Literal=function(a){var b=this;b.ID=0,b.Text=null,b.LanguageID=1,b.IsDefault=!0,d.updateProperties(b,a)},e.Multilingual=function(a){var b=this;b.ID=0,b.Literals=[new e.Literal],d.updateProperties(b,a)},e.Location=function(a){var b=this;b.ID=0,b.ParentID=0,b.Name=null,d.updateProperties(b,a)},e.Location.method("getName",function(){return this.multilingualToString("Name")}),e.Location.inheritFunctions(f,["setMultilingual","multilingualToString"]),e.SellerProfile=function(a){var b=this;b.ID=0,b.Moniker=null,b.FirstName=null,b.LastName=null,b.Title=new e.Multilingual,b.Description=new e.Multilingual,b.Resume=null,b.Status=null,b.Location=null,b.LocationID=0,b.Showcases=[],b.Reviews=[],d.updateProperties(b,a)},e.SellerProfile.prototype.fromImported=function(a){if(a){var b=this;return d.updateProperties(b,{FirstName:a.FirstName,LastName:a.LastName,Description:new e.Multilingual({Literals:[new e.Literal({Text:a.Bio})]}),Title:new e.Multilingual({Literals:[new e.Literal({Text:a.Headline})]})}),b}},e.SellerProfile.prototype.getCity=function(){return d.removeParenthesis(new e.Location(this.Location).multilingualToString("Name"))},e.SellerProfile.inheritFunctions(f,["setMultilingual","multilingualToString"]),e.User=function(a){var b=this;b.ID=0,b.Guid="",b.Avatar=null,b.AvatarID=0,b.IsSystem=!1,b.IsAnonymous=!1,b.FirstName=null,b.LastName=null,b.PreferredLanguageID=1,b.Registrations=[],b.Roles=[],d.updateProperties(b,a)},e.File=function(a){var b=this;b.FileType=null,b.FileTypeID=null,b.Name=null,b.OwnerID=0,d.updateProperties(b,a)},e.FileType=function(a){var b=this;b.ID=0,b.Name=0,b.AllowedInServiceFields=[],b.AllowedInServices=[],b.MediumCategory=0,b.MimeTypes=0,d.updateProperties(b,a)},e.Showcase=function(a){var b=this;b.ID=0,b.Description=null,b.Title=null,b.Items=[],b.Offers=[],b.Order=0,b.SellerProfileID=0,b.SourceID=0,d.updateProperties(b,a)},e.Showcase.prototype.fromImported=function(a){if(a){var b=this;return d.updateProperties(b,{Description:a.Description?new e.Multilingual({Literals:[new e.Literal({Text:a.Description})]}):null,Title:new e.Multilingual({Literals:[new e.Literal({Text:a.Description})]}),Items:[(new e.ShowcaseItem).fromImported(a)]}),b}},e.Showcase.inheritFunctions(f,["setMultilingual","multilingualToString"]),e.ShowcaseItem=function(a){var b=this;b.ID=0,b.Description=null,b.Title=null,b.Order=0,b.ShowcaseID=0,b.Showcase=null,b.FileID=0,b.File=null,b.ThumbnailID=0,b.Thumbnail=null,d.updateProperties(b,a)},e.ShowcaseItem.prototype.fromImported=function(a,b){if(a){var c=this;return d.updateProperties(c,{Description:a.Description?new e.Multilingual({Literals:[new e.Literal({Text:a.Description})]}):null,Title:new e.Multilingual({Literals:[new e.Literal({Text:a.Description})]}),File:(new e.File).fromImported(a),Thumbnail:(new e.File).fromImported(a,"thumbnail"),Showcase:b?b:null}),c}},e.ShowcaseItem.prototype.toSimpleShowcaseItem=function(a){var b=this;return d.updateProperties(new e.SimpleShowcaseItem({ID:b.ID,name:b.Title&&b.Title.Literals[0].Text,link:b.getThumbnail(),file:b.File}),a)},e.ShowcaseItem.prototype.getThumbnail=function(){return this.Thumbnail?this.Thumbnail.hasOwnProperty("Url")?this.Thumbnail.Url:c.api.hostedFiles+this.Thumbnail.RelativeUrl:"images/thumb.png"},e.ShowcaseItem.prototype.getFileLink=function(){return this.File.hasOwnProperty("Url")?this.File.Url:c.api.hostedFiles+this.File.RelativeUrl},e.SimpleShowcaseItem=function(a){var b=this;b.ID=0,b.name="Add a description",b.link="",b.file={},b.state="loading",d.updateProperties(b,a)},e.OfferField=function(a){var b=this;b.ID=0,b.OfferID=0,d.updateProperties(b,a)},e.OfferedChoice=function(a){var b=this;b.ID=0,b.OfferID=0,b.Days=0,b.Price=0,b.ServiceChoiceID=0,b.ServiceChoice={},d.updateProperties(b,a)},e}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("MainCtrl",["$scope","$location","$q","$cookies","$timeout","EVENTS","MESSAGES","ROUTES","PATHS","ENV","Utils","Odata","AccountSvc","NotificationSvc","ProfileSvc","UserSvc",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){a.currentUser={},a.avatar={},a.session={},a.updateCurrentUser=function(b){angular.extend(a.currentUser,b)},a.go=function(a){var d=c.defer();return b.path(a),d.resolve(),d.promise},a.locationAt=function(a){return a===b.path()},a.handleSignIn=function(){m.getUserInfo().then(function(b){a.session=b,a.go(a.locationAt("/register")?"/apply":"/")},function(a){console.log(a),n.show({content:g.error.generic,type:"error"})})},a.$on("$routeChangeError",function(b,c,d,e){console.log(e),e&&n.show({content:g.error.generic,type:"error"}),a.go("/")}),a.$on(f.auth.loginSuccess,function(){a.handleSignIn()}),a.$on(f.auth.registrationSuccess,function(){a.handleSignIn()}),a.$on(f.auth.logoutSuccess,function(){o.setProfile({}),a.session={},a.go("/")}),a.$on(f.auth.logoutFailed,function(){a.currentUser={},a.avatar={},a.session={},console.log(d),n.show({content:g.error.logoutFailed,type:"error"})}),a.$on(f.user.updateSuccess,function(b,c){a.currentUser=c,a.avatar=c&&c.Avatar?encodeURI(j.api.hostedFiles+c.Avatar.RelativeUrl):null,o.fetchOwnProfile().then(function(b){a.currentUser.Profile=b,a.$broadcast(f.profile.fetchProfileSuccess)})}),a.$watch("session",function(b,c){switch(!0){case b===c:return;case _.isEmpty(b):a.currentUser={};break;default:p.fetchOwnUser()}}),b.search().error&&a.go("/login").then(function(){b.url(b.path()),n.show({content:b.search().error,type:"error"})}),m.getUserInfo().then(function(b){a.session=b},function(a){console.log(a)})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("RegistrationCtrl",["$scope","$rootScope","$timeout","$alert","EVENTS","MESSAGES","Utils","AccountSvc",function(a,b,c,d,e,f,g,h){a.newUser={firstName:"",lastName:"",email:"",password:""},a.clearAuthError=function(){a.authError=!1},a.authError=!1,a.registrationInProgress=!1,a.register=_.throttle(function(g){var i,j;return i=d({content:f.warning.tooLong,type:"warning",dismissable:!0,show:!1,duration:!1}),j=c(function(){i.show()},1e4,!1),a.registrationInProgress=!0,g?void h.externalLogin(g):void h.register(a.newUser).then(function(){c.cancel(j);try{i.hide()}catch(d){console.log(d)
}a.registrationInProgress=!1,b.$broadcast(e.auth.registrationSuccess)},function(d){var g;try{i.hide()}catch(d){console.log(d)}if(c.cancel(j),a.registrationInProgress=!1,b.$broadcast(e.auth.registrationFailed),400===d.status)try{g=d.data.ModelState._identity,_.each(g,function(b){-1!==b.indexOf("is already taken")&&(a.authError=f.error.emailTaken)})}catch(d){console.log(d),a.authError=f.error.generic}else a.authError=f.error.generic})},1e3),a.isEmail=function(a){return g.testEmailPattern(a)},a.hasDigits=function(a){return/\d+/g.test(a)},a.hasNonAlphanumeric=function(a){return/\W/g.test(a)},a.hasLowercase=function(a){return/[a-z]/.test(a)},a.hasUppercase=function(a){return/[A-Z]/.test(a)}}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("LoginCtrl",["$scope","$rootScope","$alert","$timeout","EVENTS","MESSAGES","Utils","AccountSvc",function(a,b,c,d,e,f,g,h){a.email="",a.password="",a.rememberMe=!1,a.authError=!1,a.clearAuthError=function(){a.authError=!1},a.loginInProgress=!1,a.login=function(g){var i,j;return i=c({content:f.warning.tooLong,type:"warning",dismissable:!0,show:!1,duration:!1}),j=d(function(){i.show()},1e4,!1),a.loginInProgress=!0,g?void h.externalLogin(g):void h.login({email:a.email,password:a.password,rememberMe:a.rememberMe}).then(function(c){a.loginInProgress=!1,d.cancel(j);try{i.hide()}catch(g){console.log(g)}401===c.status?(a.authError=f.error.wrongCredentials,b.$broadcast(e.auth.loginFailed)):b.$broadcast(e.auth.loginSuccess)},function(c){var g;console.log(c),b.$broadcast(e.auth.loginFailed),a.loginInProgress=!1,d.cancel(j);try{i.hide()}catch(c){console.log(c)}if(400===c.status)try{g=c.data.ModelState.Email[0],a.authError=f.error.wrongCredentials}catch(c){console.log(c),a.authError=f.error.generic}else a.authError=f.error.generic})},a.isEmail=function(a){return g.testEmailPattern(a)},a.hasDigits=function(a){return/\d+/g.test(a)},a.hasNonAlphanumeric=function(a){return/\W/g.test(a)},a.hasLowercase=function(a){return/[a-z]/.test(a)},a.hasUppercase=function(a){return/[A-Z]/.test(a)}}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("StorefrontCtrl",["$scope","$modal","$timeout","$location","EVENTS","MESSAGES","Odata","ProfileSvc","PortfolioSvc","OfferSvc","MessagingSvc","NotificationSvc","ReviewSvc","UserSvc","profile",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=b({scope:a,template:"views/components/modalContactUser.html",show:!1,animation:"am-slide-top",keyboard:!1}),q=b({scope:a,template:"views/components/modalPortfolioViewer.html",show:!1,animation:"am-slide-top",keyboard:!1}),r=b({scope:a,template:"views/components/modalImageCrop.html",show:!1,animation:"am-slide-top",keyboard:!0});a.user={},a.showcaseItems=[],a.profile=o,a.isCurrentUser=a.currentUser.ID===a.profile.ID,a.reviews={},a.offers=[],a.message="",a.sender={firstName:"",lastName:"",email:""},a.steps=h.getSteps(),a.activeStep=a.steps[4],a.range=function(a){return _.range(0,a)},a.contactUser=function(){k.sendMessage(a.profile.ID,a.currentUser.id,a.sender.firstName,a.sender.lastName,a.message).then(function(){l.show({content:"Your message was successfuly sent!",type:"success"}).then(function(){c(a.closeContactModal)})},function(a){console.log(a)})},a.editProfileSection=function(b){h.setActiveStep(b),a.go("/apply")},a.removeOffer=function(b){j.removeOwnOffer(b.ID).then(function(){_.remove(a.offers,function(a){return a===b})},function(a){console.log(a),l.show({content:f.error.generic,type:"error"})})},a.editOffer=function(b){j.fetchOwnOffer(b.Service.ID).then(function(){a.editProfileSection("offer_config")},function(a){console.log(a),l.show({content:f.error.generic,type:"error"})})},a.showContactModal=function(){p.$promise.then(p.show)},a.closeContactModal=function(){p.$promise.then(p.hide)},a.showPortfolioViewerModal=function(b){a.showcaseIndex=b,q.$promise.then(q.show)},a.showImageCropModal=function(){a.isCurrentUser&&r.$promise.then(function(){a.croppedImage="",r.show()})},a.$on(e.profile.profileUpdated,function(){a.profile.image=h.getProfile().image}),j.fetchOffers(a.profile.ID).then(function(b){a.offers=b},function(a){console.log(a)}),a.isCurrentUser?a.user=a.currentUser:n.fetchUser(a.profile.ID).then(function(b){a.user=b},function(a){console.log(a)}),m.fetchReviews(a.profile.ID).then(function(b){a.reviews=b},function(a){console.log(a)}),i.fetchPortfolio(a.profile.ID).then(function(b){var c;_.each(b,function(b){c=new g.ShowcaseItem(b.Items[0]),a.showcaseItems.push(c.toSimpleShowcaseItem({state:"loaded"}))}),i.setPortfolio(b)})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ServiceSelectCtrl",["$scope","$timeout","$modal","EVENTS","MESSAGES","CatalogueSvc","OfferSvc","NotificationSvc",function(a,b,c,d,e,f,g,h){var i=c({scope:a,template:"views/components/modalPageLoading.html",show:!0,animation:"am-fade",backdropAnimation:"am-fade light",keyboard:!1,backdrop:"static"});a.offset=0,a.batch=f.batch,a.offers=[],a.services=[],a.categories=[],a.allServices=[],a.selectedService={},a.offeredServices=[],a.isOffered=function(b){return _.find(a.offeredServices,function(a){return a&&a.serviceID===b})},a.getServices=function(){f.getServices(a.offset).then(function(b){i.hide(),a.services.merge(b),a.services.totalCount=b.length,a.allServices=f.services},function(a){console.log(a),i.hide()})},a.getServicesUnderCategory=function(b){f.getServicesUnderCategory(b,a.offset).then(function(b){a.services.merge(b.services),a.services.totalCount=b.totalCount},function(a){console.log(a)})},a.showMore=function(){a.offset+=a.batch;var b=a.categories[a.categories.activeCategoryIndex].categoryID;null===b?a.getServices():a.getServicesUnderCategory(b)},f.getRootCategories().then(function(b){a.categories=b,a.categories.activeCategoryIndex=0},function(a){console.log(a)}),a.removeOffer=function(b){g.removeOwnOffer(b.ID).then(function(){_.remove(a.offers,function(a){return a===b})},function(a){console.log(a),h.show({content:e.error.generic,type:"error"})})},a.editOffer=function(b){g.fetchOwnOffer(b).then(function(){a.goToStep(3)},function(){h.show({content:e.error.generic,type:"error"})})},a.$watch("categories.activeCategoryIndex",function(b,c){switch(!0){case void 0===typeof b||b===c||0===a.categories.length:break;case 0===b:a.offset=0,a.services.empty(),a.getServices();break;default:a.offset=0,a.services.empty(),a.getServicesUnderCategory(a.categories[b].categoryID)}}),a.$watch("selectedService.serviceID",function(b){b&&g.fetchOwnOffer(b).then(function(){a.goToStep(3)},function(){h.show({content:e.error.generic,type:"error"})})}),a.$watch("currentUser",function(b){b&&g.fetchOfferedServices(a.currentUser.ID).then(function(b){var c;a.offers=b,_.each(b,function(b){c=_.find(a.services,function(a){return a.serviceID===b.ServiceID}),a.offeredServices.push(c)})})})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("OfferConfigCtrl",["$scope","$timeout","$modal","$upload","$location","$q","$alert","$filter","EVENTS","PROVIDERS_ENUM","PATHS","ENV","MESSAGES","Utils","Odata","CatalogueSvc","ProfileSvc","OfferSvc","PortfolioSvc","NotificationSvc","ImporterSvc",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){function v(b){var c,e,i=f.defer();return a.uploadInProgress=!0,d.upload({url:l.api.endPoint+k.sellerManagement.showcases+a.service.serviceID,file:b,fileFormDataName:b.name}).then(function(b){a.uploadInProgress=!1,i.resolve(b.data)},function(d){console.log(d),a.uploadInProgress=!1,i.reject(),500===d.status&&d.data&&d.data.hasOwnProperty("ExceptionName")&&d.data.hasOwnProperty("DisplayMessage")&&"Futurvention.Ergma.Business.InvalidFileTypeException"===d.data.ExceptionName?(e=h("invalidFileType")(b.name,d.data.DisplayMessage),c&&c.hide(),c=g({content:e,type:"error",show:!0})):t.show({content:m.error.generic,type:"error"})}),i.promise}function w(b,c){var d,e;s.saveUrls(b,a.service.serviceID).then(function(b){_.remove(a.showcaseItems,c),a.updateShowcaseItems(b.data)},function(f){_.remove(a.showcaseItems,c),500===f.status&&f.data&&f.data.hasOwnProperty("ExceptionName")&&f.data.hasOwnProperty("DisplayMessage")&&"Futurvention.Ergma.Business.InvalidFileTypeException"===f.data.ExceptionName?(e=h("invalidFileType")(b,f.data.DisplayMessage),d&&d.hide(),d=g({content:e,type:"error",show:!0})):t.show({content:m.error.generic,type:"error"})})}var x,y,z,A;a.deadlines=["1 day","2 days","3 days","4 days","5 days","6 days","7 days","8 days","9 days","10 days"],a.extraDeadlines=["1 extra day","2 extra days","3 extra days","4 extra days","5 extra days","6 extra days","7 extra days","8 extra days","9 extra days","10 extra days"],a.urlsToEmbed=[{url:""}],a.offer=r.getOffer(),a.showcaseItems=[],a.showcaseCollection=[],a.service={},a.priceDiscriminators=[],a.addons=[],a.fieldDictionary=[],a.importedPortfolios=[],a.selectedPortfolios=[],a.portfoliosExpanded=[],a.importersAvailable=[],a.importersFailed=[],a.importersInProgress=[],a.importersFinished=[],a.status={},a.uploadInProgress=!1,a.activeWorkSamples="owned",a.panels=[{title:"Service Description",state:"default"},{title:"Work Samples",state:"default"},{title:"Personalize your offering",state:"default",textonly:!1},{title:"Pricing / Deadlines",state:"default"}],a.panels.activePanel=0,a.setPanelState=function(a,b){a.state=b},a.closePanel=function(b){switch(b.title){case"Work Samples":a.offer.Showcases=a.showcaseCollection,s.saveShowcases(a.offer.ID,_.map(a.showcaseCollection,function(a){return a.ID})).then(function(a){console.log(a)},function(a){console.log(a)});break;case"Personalize your offering":a.saveOfferField(a.service.interview,a.service.interview.answer),a.service.fields.length>0&&a.saveOfferField(a.service.fields[0],a.service.fields[0].answer)}a.setPanelState(b,"done"),a.panels.activePanel=a.panels.indexOf(_.find(a.panels,function(a){return"default"===a.state}))},A=c({scope:a,template:"views/components/modalPageLoading.html",show:!0,animation:"am-fade-out",backdropAnimation:"am-fade light",keyboard:!1,backdrop:"static"}),x=c({scope:a,template:"views/components/modalEmbedUrl.html",show:!1,keyboard:!1,animation:"am-slide-top"}),y=c({scope:a,template:"views/components/modalCameraTag.html",show:!1,keyboard:!1,backdrop:"static",animation:"am-slide-top"}),z=c({scope:a,template:"views/components/modalPortfolioViewer.html",show:!1,animation:"am-slide-top",keyboard:!0}),a.showEmbedUrlModal=_.throttle(function(){x.$promise.then(function(){x.show()})},700),a.showCameraTagModal=function(){y.$promise.then(function(){y.show()})},a.closeEmbedUrlModal=function(){a.urlsToEmbed.empty=[""],x.hide()},a.closeCameraTagModal=function(){var a=f.defer();return y.$promise.then(function(){y.hide(),a.resolve()}),a.promise},a.matchUrlPattern=function(a){return n.matchUrlPattern(a)},a.getPortfolioCompletionState=function(b){return _.find(a.status,function(a){return a.Provider===j[b]})},a.portfolioDone=function(b){var c=a.getPortfolioCompletionState(b);return c?c.Portfolio.Total===c.Portfolio.Count:!0},a.portfolioImporting=function(b){var c=a.getPortfolioCompletionState(b);return c?c.Portfolio.Total>c.Portfolio.Count:!1},a.getPortfoliosCount=function(b){var c,d;return c=a.getPortfolioCompletionState(b),d=_.find(a.importedPortfolios,function(a){return a.Provider===b}),c?c.Portfolio.Count:d.data.length},a.toggleActiveWorkSamples=function(){a.activeWorkSamples="owned"===a.activeWorkSamples?"imported":"owned"},a.toggleExpansion=function(b){var c=a.portfoliosExpanded;-1===c.indexOf(b)?c.push(b):c.remove(function(a){return a===b})},a.displayInDetail=function(b){var c;c=_.find(a.showcaseCollection,function(a){return a.Items[0].ID===b}),s.setPortfolio(c),z.$promise.then(function(){z.show()})},a.removeShowcase=function(b){var c=_.find(a.showcaseCollection,function(a){return a.Items[0].ID===b.ID});s.deleteShowcase(c.ID).then(function(){t.show({content:m.success.showcaseDeleteSuccess,type:"success"}),_.remove(a.showcaseItems,function(a){return a.ID===b.ID}),_.remove(a.showcaseCollection,function(a){return a.Items[0].ID===b.ID})},function(a){console.log(a),t.show({content:m.error.generic,type:"error"})})},a.rearangeShowcaseItems=function(b){var c,d,e,f,g=JSON.parse(this.event.dataTransfer.getData("Text")),h=b.link;g!==h&&(c=a.showcaseItems.indexOf(_.where(a.showcaseItems,{link:g})[0]),d=a.showcaseItems.indexOf(_.where(a.showcaseItems,{link:h})[0]),a.showcaseItems=a.showcaseItems.swap(c,d),e=a.showcaseCollection.indexOf(_.find(a.showcaseCollection,function(b){return b.Items[0].ID===a.showcaseItems[c].ID})),f=a.showcaseCollection.indexOf(_.find(a.showcaseCollection,function(b){return b.Items[0].ID===a.showcaseItems[d].ID})),a.showcaseCollection=a.showcaseCollection.swap(e,f))},a.updateShowcaseTitle=function(b){var c=_.find(a.showcaseCollection,function(a){return a.ID===b.ID});console.log(c.Title,c.Title instanceof o.Multilingual),c&&(c.setMultilingual("Title",b.name),s.updateShowcaseTitle(c).then(function(a){console.log(a)},function(a){console.log(a)}))},a.togglePortfolioSelection=function(b){var c=a.selectedPortfolios;-1===c.indexOf(b)?c.push(b):c.remove(function(a){return a===b})},a.toggleTextOnly=function(){var b=a.panels[a.panels.activePanel];b.hasOwnProperty("textonly")&&(b.textonly=!b.textonly)},a.updateShowcaseItems=function(b){var c,d;_.each(b,function(b){c=new o.Showcase(b),d=new o.ShowcaseItem(c.Items[0]),a.showcaseCollection.push(c),a.showcaseItems.push(d.toSimpleShowcaseItem({state:"loaded",name:c.multilingualToString("Title")}))})},a.fetchImportedPortfolios=function(){u.fetchPortfolios(a.importersFinished).then(function(b){var c,d=b.data;_.each(d,function(b){-1===a.importedPortfolios.indexOf(b)?a.importedPortfolios.push(b):(c=_.find(a.importedPortfolios,function(a){return a===b}),c&&_.each(b.data,function(a){-1===c.indexOf(a)&&c.push(a)}))})},function(a){console.log(a)})},a.saveImportedPortfolios=function(){return 0===a.selectedPortfolios.length?void a.toggleActiveWorkSamples():void u.saveImportedPortfolios(a.service.serviceID,a.selectedPortfolios).then(function(b){a.updateShowcaseItems(b.data),a.toggleActiveWorkSamples()},function(a){console.log(a),t.show({content:m.error.profileSaveFailed,type:"error"})})},a.onFileSelect=function(b){var c,d,e=0,f=new FileReader;0!==b.length&&(_.each(b,function(b){c=new o.SimpleShowcaseItem({name:b.name}),a.showcaseItems.push(c)}),f.onload=function(g){d=g.target.result,c=_.find(a.showcaseItems,function(a){return a.name===b[e].name}),c&&c.hasOwnProperty("link")&&b[e].hasOwnProperty("type")&&n.isImage(b[e].type)&&a.$apply(function(){c.link=d}),v(b[e],d).then(function(d){_.remove(a.showcaseItems,c),a.updateShowcaseItems(d),e<b.length-1&&f.readAsDataURL(b[e++])},function(){_.remove(a.showcaseItems,c),e<b.length-1&&f.readAsDataURL(b[e++])})},f.readAsDataURL(b[e]))},a.saveUrls=function(){var b;_.each(a.urlsToEmbed,function(c){return c&&c.hasOwnProperty("url")?(b=new o.SimpleShowcaseItem({name:c.url}),a.showcaseItems.push(b),void w(c.url,b)):!1}),x.hide()},a.saveOfferField=function(b,c){c&&c.length&&r.saveOfferField(a.offer.ID,b.ID,c).then(function(a){console.log(a)},function(a){console.log(a)})},a.saveOfferedChoice=function(b){b.price>0&&r.saveOfferChoice({offerID:a.offer.ID,serviceChoiceID:b.ID,price:b.price,days:parseInt(b.days)}).then(function(a){console.log(a)})},a.fetchShowcases=function(){s.fetchShowcases(a.offer.ID).then(function(a){console.log(a)},function(a){console.log(a)})},a.saveInterviewVideo=function(b,c){r.saveInterviewVideo(a.offer.ID,a.service.interview.ID,b,c).then(function(){a.service.interview.videoUuid=n.getCameraTagUuid(b),a.service.interview.videoUrl=b},function(a){console.log(a),t.show({content:m.error.generic,type:"error"})})},a.$watch("panels.activePanel",function(){var b=_.find(a.panels,function(a){return"done"!==a.state});!b&&a.goToStep(2)}),a.$on(i.importer.polling.statusUpdated,function(b,c){a.status!==c&&(a.status=c.data,a.fetchImportedPortfolios())}),a.$on("modal.show",function(){CameraTag&&(CameraTag.setup(),CameraTag.observe("fvcam","processed",function(){var b=CameraTag.cameras.fvcam,c=b.getVideo(),d="http:"+c.formats.qvga.mp4_url,e="http:"+c.formats.qvga.thumb_url;a.closeCameraTagModal().then(function(){_.throttle(function(){a.saveInterviewVideo(d,e)},3e3)})}))}),p.getService(a.offer.ServiceID,!0).then(function(b){var c;A.hide(),a.service=b,_.each(b.options,function(b){_.each(b.choices,function(d){c=_.find(a.offer.OfferedChoices,function(a){return a.ServiceChoiceID===d.ID}),b.isPriceDiscriminator&&(d.price=c?c.Price:0),d.days=c?c.Days:1}),b.isPriceDiscriminator&&b.isMandatory&&a.priceDiscriminators.push(b),b.isPriceDiscriminator&&!b.isMandatory&&a.addons.push(b)}),_.each(a.offer.Fields,function(c){c.ServiceFieldID===b.interview.ID?a.service.interview.answer=c.Text.Literals[0].Text:a.service.fields[0].answer=c.Text.Literals[0].Text}),r.fetchOffer(a.offer.ID).then(function(b){a.offer.Fields=b.Fields,b.Fields[0]&&b.Fields[0].File&&b.Fields[0].File.Url&&(a.service.interview.videoUuid=n.getCameraTagUuid(b.Fields[0].File.Url),a.service.interview.videoUrl=b.Fields[0].File.Url,CameraTag.setup())})},function(a){A.hide(),console.log(a)}),b(function(){a.panels.activePanel=0}),u.checkStatus().then(function(b){if(a.importersAvailable=_.filter(b,function(a){return null!==a.Portfolio}),a.importersAvailable.length>0){if(a.status=b,a.importersFinished=_.filter(a.importersAvailable,function(a){return 2===a.Portfolio.CurrentStatus&&a.Portfolio.Count>0}),a.importersFailed=_.filter(a.importersAvailable,function(a){return 2===a.Portfolio.CurrentStatus&&0===a.Portfolio.Count}),a.importersAvailable.length===a.importersFailed.length)return void t.show({content:m.error.portfoliosImportFailed,type:"error"});a.importersFinished.length+a.importersFailed.length===a.importersAvailable.length?a.fetchImportedPortfolios():(a.importersInProgress=_.filter(a.importersAvailable,function(a){return 1===a.Portfolio.CurrentStatus}),u.startPolling({importers:a.importersAvailable,interval:5e3,repetitions:6}))}},function(a){console.log(a)}),s.fetchShowcases(a.offer.ID).then(function(b){a.offer.Showcases=b,a.updateShowcaseItems(a.offer.Showcases)})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ApplyCtrl",["$scope","EVENTS","ProfileSvc",function(a,b,c){a.steps=c.getSteps(),a.activeStep=c.getActiveStep()?c.getActiveStep():"import",a.goToStep=function(b){a.activeStep=a.steps[b]},a.$watch("activeStep",function(b,d){b&&b!==d&&c.setActiveStep(a.activeStep)}),a.goToStep(a.steps.indexOf(a.activeStep))}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ApplyInfoCtrl",["$scope","$modal","$timeout","EVENTS","MESSAGES","Utils","Odata","ProfileSvc","LocationSvc","ImporterSvc","UserSvc","NotificationSvc",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){h.fetchOwnProfile().then(function(b){a.profileExists=!0,a.profile=b,i.fetchLocationNames(a.profile.LocationID).then(function(b){a.cityName=b.results[0].value[0].Name.Literals[0].Text,a.countryName=b.results[0].value[0].Parent.Name.Literals[0].Text})},function(){a.profileExists=!1,j.fetchProfile().then(function(b){a.profile=b.profile,!b.avatar||0!==a.currentUser.AvatarID&&null!==a.currentUser.AvatarID||(a.avatarLoading=!0,k.saveExternalAvatar(b.avatar).then(function(){a.avatarLoading=!1},function(){l.show({content:e.error.saveAvatarFailed,type:"error"}),a.avatarLoading=!1})),b.country&&(a.countryName=b.country,b.city&&c(function(){a.country&&i.searchCity(a.country.ID,b.city).then(function(b){b&&b[0]&&(a.cities=b,a.cityName=b[0].getName())},function(a){console.log(a)})})),b.userName.length>3&&b.userName.length<20&&a.engAndNum("LukeODwyer")&&h.validateMoniker(b.userName).then(function(c){"false"===c.data&&(a.monikerIsValid=!0,a.profile.Moniker=b.userName)},function(a){console.log(a)})},function(){j.getStoredImporters().then(function(a){a&&a.length>0&&j.startPolling({importers:a,delay:5e3,count:6})})})})}var n=b({scope:a,template:"views/components/modalImageCrop.html",show:!1,animation:"am-slide-top",keyboard:!0}),o=b({scope:a,template:"views/components/modalPolling.html",show:!1,animation:"am-fade",backdropAnimation:"am-fade light",keyboard:!1,backdrop:"static"});a.avatarLoading=!1,a.profile=h.getProfile(),a.profileExists=!1,a.showImageCropModal=function(){n.$promise.then(function(){a.croppedImage="",n.show()})},a.monikerIsValid=!1,a.city={},a.cities=[],a.cityName="",a.cityNames=[],a.countries=[],a.countryName="",a.countryNames=[],a.validateMoniker=function(){h.validateMoniker(a.profile.Moniker).then(function(b){a.monikerIsValid=!b.data},function(a){console.log(a)})},a.continue=function(){switch(!0){case a.profileInfoForm.$pristine:break;case a.profileExists:h.patchProfile(f.removeEmptyProperties(a.profile),a.profile.ID).then(function(a){console.log(a)},function(a){console.log(a)});break;default:h.createProfile(f.removeEmptyProperties(a.profile)).then(function(a){console.log(a)},function(a){console.log(a)})}a.goToStep(2)},a.searchCity=_.throttle(function(b){a.country&&b&&i.searchCity(a.country.ID,b).then(function(b){c(function(){a.cities=b,a.cityNames=_.map(b,function(a){return a.getName()})})},function(a){console.log(a)})},700),a.engAndNum=function(a){return f.matchEngAndNum(a)},a.$watch("profile",function(b,c){var d;b&&b!==c&&0!==a.profile.LocationID&&(d=_.find(a.countries,function(b){return b.ID===a.profile.LocationID}),a.countryName=d?d.getName():null)}),a.$watch("cityName",function(b,c){b&&b!==c&&(a.city=_.find(a.cities,function(b){return b.getName()===a.cityName}),a.profile.LocationID=a.city&&a.city.ID)}),a.$watch("countryName",function(b,c){b&&b!==c&&(a.country=_.find(a.countries,function(b){return b.getName()===a.countryName}))}),a.$watch("profile.Moniker",function(b,c){b&&b!==c&&a.validateMoniker()}),a.$on(d.profile.profileUpdated,function(){a.profile=h.getProfile()}),a.$on(d.importer.polling.start,function(){o.$promise.then(function(){o.show()})}),a.$on(d.importer.polling.end,function(){o.hide()}),a.$on(d.importer.polling.profileImported,function(){j.fetchProfile().then(function(b){j.stopPolling(),a.profile=b.profile,!b.avatar||0!==a.currentUser.AvatarID&&null!==a.currentUser.AvatarID||(a.avatarLoading=!0,k.saveExternalAvatar(b.avatar).then(function(){a.avatarLoading=!1},function(){l.show({content:e.error.saveAvatarFailed,type:"error"}),a.avatarLoading=!1})),b.country&&(a.countryName=b.country,b.city&&c(function(){a.country&&i.searchCity(a.country.ID,b.city).then(function(b){b&&b[0]&&(a.cities=b,a.cityName=b[0].getName())},function(a){console.log(a)})})),b.userName.length>3&&b.userName.length<20&&a.engAndNum("LukeODwyer")&&h.validateMoniker(b.userName).then(function(c){"false"===c.data&&(a.monikerIsValid=!0,a.profile.Moniker=b.userName)},function(a){console.log(a)})},function(a){console.log(a),j.stopPolling(),l.show({content:e.error.importProfileTimeout,type:"error"})})}),_.each(j.getImporters(),function(b){f.updateProperties(b,{Guid:a.currentUser.Guid})}),i.getCountries().then(function(b){a.countries=b,a.countryNames=_.map(b,function(a){return a.getName()}),m()},function(a){console.log(a),m()})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ApplyImportCtrl",["$scope","EVENTS","Utils","ImporterSvc",function(a,b,c,d){a.importers=[],a.selectedImporters=[],a.oldImporters=[],a.toggleSelection=function(c){switch(!0){case a.isOld(c):return;case a.isSelected(c):return void _.remove(a.selectedImporters,c);default:a.selectedImporters.push(c),a.$broadcast(b.ui.providerSelected,c.Provider)}},a.isSelected=function(b){return a.selectedImporters.indexOf(b)>-1},a.isOld=function(b){return angular.isDefined(_.find(a.oldImporters,function(a){return a.Provider===b.Provider}))},a.import=function(){_.remove(a.selectedImporters,function(a){return""===a.Url}),d.import(a.selectedImporters).then(function(){a.goToStep(1)})},a.removeImporter=function(b){a.isOld(b)&&(_.remove(a.oldImporters,b),d.storeImporters(a.oldImporters)),a.toggleSelection(b)},a.ignoreInputs=function(){var b,c;return c=_.filter(a.selectedImporters,function(b){return!a.isOld(b)}),c&&0!==c.length?(b=_.filter(c,function(a){return""===a.Url}),b=b?b:[],c.length===b.length):!0},a.validateImporterFormat=function(a,b){return a?c.matchProviderUrlPattern(a,b.Provider):[]},a.importers=d.getImporters(),_.each(a.importers,function(b){c.updateProperties(b,{Guid:a.currentUser.Guid})}),d.setImporters(a.importers),d.getStoredImporters().then(function(b){var d;_.each(b,function(b){d=_.find(a.importers,function(a){return a.Provider===b.Provider}),c.updateProperties(d,b),a.oldImporters.push(d),a.selectedImporters.push(d)})},function(a){console.log(a)})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("OfferCtrl",["$scope","$modal","PATHS","EVENTS","ENV ","offer","ReviewSvc","UserSvc","PortfolioSvc","CatalogueSvc","ProfileSvc","LocationSvc",function(a,b,c,d,e,f,g,h,i,j,k,l){a.reviews=[],a.portfolio={},a.service={},a.offer=e,a.isCurrentUser=!1,a.expandServiceDescription=!1;var m=b({scope:a,template:"views/components/modalContactUser.html",show:!1,animation:"am-slide-top",keyboard:!1});a.range=function(a){return _.range(0,a)},a.showContactModal=function(){m.$promise.then(m.show)},a.closeContactModal=function(){m.$promise.then(m.hide)},k.fetchProfileById(a.offer.SellerProfileID).then(function(b){a.profile=b[0],a.avatarUrl=a.profile.User&&a.profile.User.Avatar?encodeURI(f.api.hostedFiles+a.profile.User.Avatar.RelativeUrl):null,a.isCurrentUser=a.profile.ID===a.currentUser.ID,a.$broadcast(d.profile.fetchProfileSuccess,a.isCurrentUser),l.fetchLocationNames(a.profile.LocationID).then(function(b){a.profile.countryName=b.results[0].value[0].Parent.Name.Literals[0].Text},function(a){console.log(a)})},function(a){console.log(a)}),g.fetchReviews(a.offer.SellerProfileID).then(function(b){a.reviews=b},function(a){console.log(a)}),j.getService(a.offer.ServiceID).then(function(b){a.service=b},function(a){console.log(a)}),i.fetchShowcases(a.offer.ID).then(function(b){a.offer.Showcases=b,i.setPortfolio(b)},function(a){console.log(a)})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ModalImageCropCtrl",["$http","$rootScope","$scope","$timeout","$upload","PATHS","ENV","EVENTS","MESSAGES","Utils","UserSvc","NotificationSvc",function(a,b,c,d,e,f,g,h,i,j,k,l){c.file={},c.init=function(a){c.uncroppedImage="",c.croppedImage="",c.tempImage="",c.setProgress(a)},c.updateCroppedImage=function(a){c.croppedImage=a},c.onFileSelect=function(a){var b=new FileReader;b.onloadstart=function(){c.setProgress(!0)},b.onload=function(a){d(function(){c.uncroppedImage=a.target.result,c.setProgress(!1)})},b.readAsDataURL(a[0]),c.file=a[0]},c.setProgress=function(a){c.inProgress=a},c.saveAvatar=function(){var b=new FormData,d=c.croppedImage.split(",").pop(),e=c.file.name.split(".").slice(0,1)[0].concat(".png");b.append(e,j.base64toBlob(d,"image/png"),e),a.post(g.api.endPoint+f.user.ownAvatar,b,{withCredentials:!0,headers:{"Content-Type":void 0},transformRequest:angular.identity}).then(function(){k.fetchOwnUser().then(function(){c.$hide()},function(a){console.log(a),l.show({content:i.error.generic,type:"error"})})},function(a){console.log(a)})},c.init()}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ForgotPwdCtrl",["$scope","AccountSvc","MESSAGES","NotificationSvc",function(a,b,c,d){a.email="",a.forgotPassword=function(){b.forgotPassword(a.email).then(function(b){console.log(b),d.show({content:c.success.createNewPassword,type:"success"}).then(function(){a.go("/login")})},function(a){console.log(a),d.show({content:c.error.generic,type:"error"})})}}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ResetPwdCtrl",["$scope","$alert","MESSAGES","EVENTS","Utils","AccountSvc","ProfileSvc",function(a,b,c,d,e,f,g){var h;a.oldPassword="",a.newPassword="",a.confirmPassword="",a.authError=!1,a.resetPassword=function(){var d={OldPassword:a.oldPassword,NewPassword:a.newPassword,ConfirmPassword:a.confirmPassword};f.resetPassword(d).then(function(){try{h&&h.hide()}catch(a){console.log(a)}h=b({content:c.success.resetPassword,type:"success",dismissable:!0,show:!0,duration:!1})},function(b){if(console.log(b),400===b.status)try{_.each(b.data.ModelState._identity,function(b){-1!==b.indexOf("Incorrect password")&&(a.authError=c.error.wrongPassword)})}catch(b){console.log(b),a.authError=c.error.generic}else a.authError=c.error.generic})},a.onPwdInputChange=function(){a.authError=!1;try{h&&h.hide()}catch(b){console.log(b)}},a.hasDigits=function(a){return/\d+/g.test(a)},a.hasNonAlphanumeric=function(a){return/\W/g.test(a)},a.hasLowercase=function(a){return/[a-z]/.test(a)},a.hasUppercase=function(a){return/[A-Z]/.test(a)},a.$on(d.ui.alertClosed,function(){g.fetchOwnProfile().then(function(b){a.go("/"+b.Moniker)},function(){a.go("/")})}),a.$on("$destroy",function(){try{h&&h.hide()}catch(a){console.log(a)}})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("HeaderCtrl",["$rootScope","$scope","EVENTS","AccountSvc",function(a,b,c,d){b.dropdown=[],b.logout=function(){d.logout().then(function(){a.$broadcast(c.auth.logoutSuccess),b.dropdown=[{text:"Change Password",href:"#resetPassword"},{divider:!0},{text:"Signout",click:b.logout}]},function(b){a.$broadcast(c.auth.logoutFailed,event,b)})},b.dropdown=[{text:"Change Password",href:"#resetPassword"},{divider:!0},{text:"Signout",click:b.logout}],b.$on(c.profile.fetchProfileSuccess,function(){b.currentUser&&b.currentUser.Profile&&b.currentUser.Profile.Moniker&&(b.dropdown=[{text:"My Profile",href:"#"+b.currentUser.Profile.Moniker},{text:"Change Password",href:"#resetPassword"},{divider:!0},{text:"Signout",click:b.logout}])})}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("LandingCtrl",["$scope",function(a){a.continue=function(){a.go(a.session.hasRegistered?"/apply":"/register")}}])}(),function(){"use strict";var a=angular.module("fvApp");a.controller("ModalPollingCtrl",["$scope","$rootScope","EVENTS","ImporterSvc",function(a,b,c,d){a.closeLoader=function(){a.$parent.$hide(),d.stopPolling()}}])}(),function(){"use strict";var a=angular.module("fvApp");a.directive("fvOrderBox",["$location","MESSAGES","EVENTS","ProfileSvc","OfferSvc","NotificationSvc",function(a,b,c,d,e,f){return{restrict:"E",scope:{offer:"="},replace:!0,templateUrl:"views/directives/fv-order-box.html",link:function(g){var h,i=g.offer,j=g.offer.Service;g.addons=[],g.mainPriceDiscriminator={},g.isCurrentUser=!1,g.editOffer=function(){e.fetchOwnOffer(j.ID).then(function(){d.setActiveStep("offer_config"),a.path("/apply")},function(){f.show({content:b.error.generic,type:"error"})})},g.$on(c.profile.fetchProfileSuccess,function(a,b){g.isCurrentUser=b}),_.each(j.Options,function(a){switch(!0){case!a.IsPriceDiscriminator:break;case a.IsMandatory:g.mainPriceDiscriminator=a;break;default:g.addons.push(a)}}),_.each(i.OfferedChoices,function(a){h=_.find(g.addons,function(b){return b.ID===a.ServiceChoice.Option.ID}),h&&(h.Choices[0].price=a.Price,h.Choices[0].days=a.Days),_.each(g.mainPriceDiscriminator.Choices,function(b){b.ID===a.ServiceChoiceID&&(b.price=a.Price,b.days=a.Days)})})}}}])}(),function(){"use strict";var a=angular.module("fvApp");a.directive("fvPortfolioViewer",["Odata","PortfolioSvc",function(a,b){var c=7;return{restrict:"E",scope:{fvHideGallery:"@"},templateUrl:"views/directives/fv-portfolio-viewer.html",link:function(d){d.showcases=b.getPortfolio(),d.showcaseItems=[],d.showcasePrev=function(){d.showcaseIndex>0&&(d.showcaseIndex-=1)},d.showcaseNext=function(){d.showcaseIndex<d.showcases.length-1&&(d.showcaseIndex+=1)},d.goToShowcaseItem=function(a){d.showcaseIndex=a},_.each(d.showcases,function(b){d.showcaseItems.push(new a.ShowcaseItem(b.Items[0]))}),d.$watch("showcaseIndex",function(a,b){a>=c&&a>b&&(d.galleryIndex+=1),a>0&&b>a&&(d.galleryIndex-=1)})}}}])}(),function(){"use strict";var a=angular.module("fvApp");a.directive("fvDynamicIcon",function(){return{restrict:"E",scope:!0,templateUrl:"views/directives/fv-dynamic-icon.html",link:function(a,b,c){a.provider=c.provider}}})}(),function(){"use strict";
var a=angular.module("fvApp");a.directive("fvShowcaseItem",["$sce","FILE_TYPE_CONFIG","PATHS","Odata",function(a,b,c,d){return{restrict:"E",scope:!0,templateUrl:"views/directives/fv-showcase-item.html",link:function(c){if(c.showcase)switch(c.link=null,c.item=new d.ShowcaseItem(c.showcase.Items[0]),!0){case c.item.File.hasOwnProperty("EmbedCode"):c.type="embedCode",c.trustedPlayer=a.trustAsHtml(c.item.File.EmbedCode);break;case c.item.File.hasOwnProperty("RelativeUrl"):c.link=c.item.getFileLink(),c.type=_.find(b,function(a){return a.ID===c.item.File.MimeTypeID}).Viewer;break;default:c.link=c.item.File.AbsoluteUrl,c.type=_.find(b,function(a){return a.ID===c.item.File.MimeTypeID}).Viewer}}}}])}(),function(){"use strict";var a=angular.module("fvApp");a.directive("fvShowcaseThumb",["Odata",function(a){return{restrict:"E",scope:{showcase:"=",caption:"@"},templateUrl:"views/directives/fv-showcase-thumb.html",link:function(b){var c=new a.ShowcaseItem(b.showcase.Items[0]);switch(b.thumbnailLink="",!0){case!c.hasOwnProperty("Thumbnail")||null===c.Thumbnail:b.thumbnailLink="images/thumb.png";break;case c.Thumbnail.hasOwnProperty("Url"):b.thumbnailLink=c.Thumbnail.Url;break;case c.Thumbnail.hasOwnProperty("RelativeUrl"):b.thumbnailLink=c.getFileLink()}}}}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("LocationSvc",["$q","$http","breeze","PATHS","ENV","Odata",function(a,b,c,d,e,f){function g(a){return _.map(a,function(a){return new f.Location(a)})}var h={},i=new c.DataService({serviceName:e.api.endPoint+d.public,hasServerMetadata:!1}),j=new c.EntityManager({dataService:i});return h.searchCity=function(c,f){var h=a.defer(),i=[e.api.endPoint+d.public,"CitiesByPrefix","?format=json","&countryID=",c,"&prefix=","'",f,"'","&$format=json","&$expand=Name/Literals"].join("");return b.get(i).then(function(a){h.resolve(g(a.data.value))},function(a){h.reject(a)}),h.promise},h.fetchLocationNames=function(a){var b=new c.EntityQuery("Locations").where("ID","eq",a).expand("Name.Literals,Parent.Name.Literals");return j.executeQuery(b)},h.getCountries=function(){var b=a.defer(),d=new c.EntityQuery("CountriesLocations").expand("Name.Literals");return j.executeQuery(d).then(function(a){b.resolve(g(a.results[0].value))},function(a){console.log(a)}),b.promise},h}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("AccountSvc",["$q","$http","$timeout","PATHS","MESSAGES","ENV","NotificationSvc",function(a,b,c,d,e,f,g){var h={};return h.register=function(a){return b.post(f.api.endPoint+d.account.register,{Email:a.email,Password:a.password,ConfirmPassword:a.password,FirstName:a.firstName,LastName:a.lastName})},h.login=function(a){return b.post(f.api.endPoint+d.account.login,{Email:a.email,Password:a.password,RememberMe:a.rememberMe})},h.logout=function(){var c=a.defer();return b.post(f.api.endPoint+d.account.logout,{}).then(function(){localStorage.removeItem("importers"),c.resolve()},function(a){c.reject(a)}),c.promise},h.forgotPassword=function(b){var c=a.defer();return c.resolve(b),c.promise},h.resetPassword=function(a){return b.post(f.api.endPoint+d.account.resetPassword,a)},h.getUserInfo=function(){var c=a.defer();return b.get(f.api.endPoint+d.account.userInfo).then(function(a){c.resolve({email:a.data.UserName,userID:a.data.UserID,authProvider:a.data.LoginProvider,hasRegistered:a.data.HasRegistered})},function(a){console.log(a),c.reject(a)}),c.promise},h.externalLogins=function(){return b.get(f.api.externalLogins)},h.externalLogin=function(a){h.externalLogins().then(function(b){window.location.replace(f.api.endPoint+_.find(b.data,function(b){return b.Name===a}).Url)},function(a){console.log(a),g.show({content:e.error.generic,type:"error"})})},h}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("CatalogueSvc",["$http","$q","$timeout","breeze","PATHS","ENV",function(a,b,c,d,e,f){function g(a){return _.pluck(a.results[0].value,function(a){return{categoryID:a.ID,categoryName:a.Name.Literals[0].Text}})}function h(a){return _.pluck(a.results[0].value,function(a){return{serviceID:a.ID,shortTitle:a.ShortTitle.Literals[0].Text,thumbnail:{link:a.ThumbnailFile.Url}}})}function i(a){return a.results[0]["odata.count"]}function j(a){var b=a.results[0].value[0],c={serviceID:b.ID,title:b.Title&&b.Title.Literals[0].Text,shortTitle:b.ShortTitle&&b.ShortTitle.Literals[0].Text,description:b.Description&&b.Description.Literals[0].Text,deliverables:b.ExpectedDeliverables&&b.ExpectedDeliverables.Literals[0].Text,provision:b.BuyerProvision&&b.BuyerProvision.Literals[0].Text,options:b.Options,excluded:b.ExcludedServices&&b.ExcludedServices.Literals[0].Text,viewHint:b.ViewHint,thumbnail:{link:b.ThumbnailFile.Url},showcasePrompt:b.ShowcasePrompt&&b.ShowcasePrompt.Literals[0].Text};return c.allowedShowcaseFileTypes=_.pluck(b.AllowedShowcaseFileTypes,function(a){return a.Name&&a.Name.Literals[0].Text}),c.options=b.Options.map(function(a){return{ID:a.ID,isPriceDiscriminator:a.IsPriceDiscriminator,isMandatory:a.IsMandatory,isDaysDiscriminator:a.IsDaysDiscriminator,overridesDays:a.OverridesDays,sellerTitle:a.SellerTitle&&a.SellerTitle.Literals[0].Text,choices:a.Choices.map(function(a){return{ID:a.ID,name:a.Name&&a.Name.Literals[0].Text,price:0,days:1}})}}),c.fields=b.Fields.map(function(a){return{ID:a.ID,allowedFileTypes:_.pluck(a.AllowedFileTypes,function(a){return a.Name&&a.Name.Literals[0].Text}),order:a.Order,isMandatory:a&&a.IsRequired?!0:!1,sellerLabel:a&&a.SellerLabel&&a.SellerLabel.Literals[0].Text}}),c.interview=_.find(c.fields,function(a){return 0===a.order}),_.remove(c.fields,function(a){return 0===a.order}),c}var k={},l=new d.DataService({serviceName:f.api.endPoint+e.cached,hasServerMetadata:!1}),m=new d.EntityManager({dataService:l});return k.services=[],k.batch=16,k.getRootCategories=function(){var a=b.defer(),c=new d.EntityQuery("RootCategories").expand("Name.Literals");return m.executeQuery(c).then(function(b){var c=g(b);c.unshift({categoryID:null,categoryName:"All"}),a.resolve(c)},function(b){a.reject(b)}),a.promise},k.getService=function(a,c){var e=b.defer(),f=new d.EntityQuery("Services").where("ID","eq",a).expand(["Title.Literals","ShortTitle.Literals","Description.Literals","ThumbnailFile","ExpectedDeliverables.Literals","BuyerProvision.Literals","ExcludedServices.Literals","AllowedShowcaseFileTypes.Name.Literals","ShowcasePrompt.Literals","Fields","Fields.AllowedFileTypes.Name.Literals","Fields.AllowedFileTypes.MimeTypes","Fields.SellerLabel.Literals","Fields.Order","Options.SellerTitle.Literals","Options.Choices.Name.Literals"].join(", "));return m.executeQuery(f).then(function(a){e.resolve(c?j(a):a.results[0].value[0])},function(a){e.reject(a)}),e.promise},k.getServices=function(a){var c=b.defer(),e=new d.EntityQuery("Services").expand("ShortTitle.Literals, ThumbnailFile");return k.services.length>0&&c.resolve(k.services.slice(a,a+k.batch)),0===k.services.length&&m.executeQuery(e).then(function(b){k.services=h(b),c.resolve(k.services.slice(a,a+k.batch))},function(a){c.reject(a)}),c.promise},k.getServicesUnderCategory=function(a,c){var e=b.defer(),f=new d.EntityQuery("ServicesUnderCategory").withParameters({CategoryID:a}).skip(c).take(k.batch).expand("ShortTitle.Literals, ThumbnailFile").inlineCount();return m.executeQuery(f).then(function(a){e.resolve({services:h(a),totalCount:i(a)})},function(a){e.reject(a)}),e.promise},k}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("OfferSvc",["$http","$q","$timeout","Enum","PATHS","ENV","breeze","PortfolioSvc",function(a,b,c,d,e,f,g,h){var i={},j={},k=[],l=new g.DataService({serviceName:f.api.endPoint+e.public,hasServerMetadata:!1}),m=new g.EntityManager({dataService:l});return i.addOffer=function(a){var b=a||j;k.push(b)},i.removeOffer=function(a){var b=a||j.serviceID;k.remove(function(a){return a.serviceID===b})},i.getOffer=function(){return j},i.fetchOffers=function(a){var c=b.defer(),d=new g.EntityQuery("Offers").where("SellerProfileID","eq",a).expand(["Service","Service.ShortTitle.Literals","Service.ThumbnailFile"].join(","));return m.executeQuery(d).then(function(a){k=a.results[0]&&a.results[0].value,c.resolve(k)},function(a){console.log(a),c.reject(a)}),c.promise},i.fetchOwnOffer=function(c){var d=b.defer(),g=[f.api.endPoint+e.offerManagement.ownOffers,"?serviceID=",c,"&expand=Fields/File,","Fields/Thumbnail"].join("");return a.put(g).then(function(a){j=a.data,d.resolve(j)},function(a){d.reject(a)}),d.promise},i.fetchOffer=function(a){var c=b.defer(),d=new g.EntityQuery("Offers").where("ID","eq",parseInt(a)).expand(["Service","Service.Options","Service.ShortTitle.Literals","Service.ThumbnailFile","Service.Options.SellerTitle.Literals","Service.Options.BuyerTitle.Literals","Service.Options.Choices","OfferedChoices.ServiceChoice.Option","Fields.File","Fields.Text.Literals","Fields.ServiceField.SellerLabel.Literals"].join(","));return m.executeQuery(d).then(function(a){j=a.results[0]&&a.results[0].value[0],j?(h.setPortfolio(j.Showcases),c.resolve(j)):c.reject()},function(a){console.log(a),c.reject(a)}),c.promise},i.fetchOfferedServices=function(){var c=b.defer();return a.get(f.api.endPoint+e.offerManagement.offeredServices).then(function(a){c.resolve(a.data)},function(a){c.reject(a)}),c.promise},i.saveOffer=function(b){return a({method:"PATCH",url:f.api.endPoint+e.offerManagement.ownOffers+"/"+b.ID,data:b})},i.saveOfferField=function(b,c,d){return a({method:"PUT",url:[f.api.endPoint+e.offerManagement.ownOffers,"/",b,"/Fields/Inline?ServiceFieldID=",c].join(""),data:JSON.stringify(d)})},i.saveInterviewVideo=function(b,c,d,g){var h=[f.api.endPoint+e.offerManagement.ownOffers,"/",b,"/Fields","?serviceFieldID=",c,"&useDirectLinks=true"].join("");return a({method:"PUT",url:h,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:{url:d,thumbnailUrl:g}})},i.saveOfferChoice=function(b){return a({method:"PUT",url:[f.api.endPoint+e.offerManagement.ownOffers,"/",b.offerID,"/Choices?serviceChoiceID=",b.serviceChoiceID,"&price=",b.price,"&days=",b.days].join("")})},i.removeOwnOffer=function(b){return a.delete(f.api.endPoint+e.offerManagement.ownOffers+"/"+b)},i}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("ProfileSvc",["$http","$q","$upload","$timeout","IMPORT_PROVIDERS","PATHS","ENV","breeze","Utils","Odata",function(a,b,c,d,e,f,g,h,i,j){var k={},l=e,m=["import","info","service_selection","offer_config","storefront"],n="import",o=new j.SellerProfile,p=new h.DataService({serviceName:g.api.endPoint+f.public,hasServerMetadata:!1}),q=new h.EntityManager({dataService:p});try{n=JSON.parse(localStorage.getItem("activeStep"))}catch(r){console.log(r),n="import"}return k.Provider=function(a,b){this.name=a,this.url=b},k.initProviders=function(){var a={};return _.forEach(l,function(b){a[b]=new k.Provider(b,"")}),a},k.getActiveStep=function(){return n},k.getProfile=function(){return o},k.getSteps=function(){return m},k.setActiveStep=function(a){n="offer_config"===a?"service_selection":a;try{localStorage.setItem("activeStep",JSON.stringify(n))}catch(b){console.log(b)}},k.updateProfile=function(a){i.updateProperties(o,a)},k.setProfile=function(a){o=_.isEmpty(a)?new j.SellerProfile:a},k.createProfile=function(b){return a.post(g.api.endPoint+f.sellerManagement.ownProfile,b)},k.patchProfile=function(b){return a({method:"PATCH",url:g.api.endPoint+f.sellerManagement.ownProfile,data:b})},k.saveProfileStatus=function(b){return a({method:"POST",url:g.api.endPoint+f.sellerManagement.profileStatus,data:b})},k.fetchOwnProfile=function(){var c=b.defer();return a.get(g.api.endPoint+f.sellerManagement.ownProfile+"?expand=User, Title/Literals, Description/Literals").then(function(a){i.updateProperties(o,a.data),c.resolve(o)},function(a){c.reject(a)}),c.promise},k.fetchProfile=function(c){var d=b.defer(),e=[g.api.endPoint+f.sellerManagement.profile,c,"?expand=Location/Name/Literals,","Title/Literals,","Description/Literals"].join("");return a.get(e).then(function(a){a&&null===a.data||"null"===a.data?d.reject():(i.updateProperties(o,a.data),d.resolve(o))},function(a){d.reject(a)}),d.promise},k.fetchProfileById=function(a){var c=b.defer(),d=new h.EntityQuery("SellerProfiles").where("ID","eq",a).expand(["User","User.Avatar","Location.Name.Literals","Title.Literals","Description.Literals"].join(","));return q.executeQuery(d).then(function(a){console.log(a),c.resolve(a.results[0].value)},function(a){console.log(a),c.reject(a)}),c.promise},k.fetchProfileStatus=function(){var c=b.defer();return a.get(g.api.endPoint+f.sellerManagement.profileStatus).then(function(a){c.resolve(a)},function(a){console.log(a)}),c.promise},k.validateMoniker=function(b){return a.get(g.api.endPoint+f.sellerManagement.monikerExists(b))},k}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("ImporterSvc",["$rootScope","$http","$q","$timeout","$interval","$alert","PATHS","ENV","PROVIDERS_ENUM","EVENTS","MESSAGES","Utils","Odata",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){return"undefined"!=typeof _.find(a,function(a){return 2===a.Profile})}function o(a){var b=!1,c=!1,d=!1,e=!0;return _.each(a,function(a){return c=2===a.Profile,d=a.Portfolio&&a.Portfolio.hasOwnProperty("CurrentStatus")&&2===a.Portfolio.CurrentStatus,e=2===a.Reviews,b=c&&d&&e,b?void 0:!1}),b}var p,q,r=_.keys(i),s=[],t=[],u={};return u.Importer=function(a){var b=this;b.Provider="",b.Url="",b.Guid="",l.updateProperties(b,a)},u.getImporters=function(){return t},u.setImporters=function(a){t=a},u.getStoredImporters=function(){var a,b=[],d=c.defer();try{a=JSON.parse(localStorage.getItem("importers")),_.each(a,function(a){b.push(new u.Importer(a))}),d.resolve(b)}catch(e){d.reject(e)}return d.promise},u.storeImporters=function(a){var b=c.defer();try{localStorage.setItem("importers",JSON.stringify(a)),b.resolve()}catch(d){b.reject(d)}return b.promise},u.updateGuid=function(a){_.each(t,function(b){l.updateProperties(b,{Guid:a})})},u.stopPolling=function(){d.cancel(q),e.cancel(p),a.$broadcast(j.importer.polling.end),p=null},u.startPolling=function(b){var c,g,h,i;a.$broadcast(j.importer.polling.start),c=b.hasOwnProperty("importers")?b.importers:u.getImporters(),g=b.hasOwnProperty("delay")?b.delay:6e3,h=b.hasOwnProperty("count")?b.count:5,i=g*h+1e3,q=d(function(){f({content:k.error.importProfileTimeout,type:"error",show:!0}),a.$broadcast(j.importer.polling.end)},i),p=e(function(){u.checkStatus(c,!0)},g,h,!1)},u.checkStatus=function(d,e){var f=d?d:t,i=c.defer();return b.post(h.api.endPoint+g.importer.checkProgress,f).then(function(b){o(b.data)&&u.stopPolling(),n(b.data)&&e&&a.$broadcast(j.importer.polling.profileImported,b),i.resolve(b.data)},function(a){i.reject(a)}),i.promise},u.import=function(a){var d=c.defer();return b.post(h.api.endPoint+g.importer.import,a).then(function(b){u.storeImporters(a),d.resolve(b)},function(a){d.reject(a)}),d.promise},u.fetchProfile=function(){var a,d,e,f,j=[],k=[],n=new m.SellerProfile,o=[],p=c.defer();return b.post(h.api.endPoint+g.importer.fetchProfile,t).then(function(b){return _.each(b.data,function(a){a.hasOwnProperty("data")&&null!==a.data&&j.push(a)}),j&&0!==j.length?(_.each(j,function(a){a.data.response.data&&parseInt(a.data.response.error.errno)<500&&(k.push((new m.SellerProfile).fromImported(a.data.response.data.PersonalInfo)),o.push(angular.extend(a.data.response.data.PersonalInfo,{provider:i[a.Provider],guid:a.Guid,userName:a.data.response.data.Metadata.hasOwnProperty("UserName")?a.data.response.data.Metadata.UserName:""})))}),_.each(k,function(a){l.updateProperties(n,a,!1)}),a=_.find(o,function(a){return a.hasOwnProperty("Country")&&""!==a.Country}),e=a?a.Country:"",a=_.find(o,function(a){return a.hasOwnProperty("City")&&""!==a.City}),f=a?a.City:"",a=_.find(o,function(a){return a.hasOwnProperty("Photo")&&""!==a.Photo}),d=null!==a&&a.Photo?[g.importer.importedData,a.guid,"/",a.provider,"/avatar.jpg"].join(""):"",void p.resolve({profile:n,avatar:d,country:e,city:f,userName:a.userName})):void p.reject()},function(a){p.reject(a)}),p.promise},u.fetchPortfolios=function(a){var d,e=c.defer();return d=a?a:t,b.post(h.api.endPoint+g.importer.fetchPortfolios,d).then(function(a){s=a,e.resolve(a)},function(a){e.reject(a)}),e.promise},u.fetchCachedPortfolios=function(a){return b.post(h.api.endPoint+g.importer.fetchPortfolios,_.map(r,function(b){return new u.Importer({Guid:a,Provider:b,Url:""})}))},u.saveImportedPortfolios=function(a,c){return b.post(h.api.endPoint+g.sellerManagement.importedShowcases+a,c)},u.saveReviews=function(a){return b.post(h.api.endPoint+g.sellerManagement.ownReviews,a)},_.each(r,function(a){t.push(new u.Importer({Provider:a}))}),u}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("UserSvc",["$rootScope","$http","$q","PATHS","ENV","EVENTS","Odata","breeze","ImporterSvc",function(a,b,c,d,e,f,g,h,i){var j={},k=new h.DataService({serviceName:e.api.endPoint+d.public,hasServerMetadata:!1}),l=new h.EntityManager({dataService:k});return j.fetchOwnUser=function(){var h=c.defer();return b.get(e.api.endPoint+d.user.self).then(function(b){var c=new g.User(b.data);a.$broadcast(f.user.updateSuccess,c),i.updateGuid(c.Guid),h.resolve(c)},function(a){h.reject(a)}),h.promise},j.fetchUser=function(a){var b=c.defer(),d=new h.EntityQuery("User/Futurvention.Ergma.DataAccess.EntityFramework.ErgmaUser").expand("Avatar").where("ID","eq",a);return l.executeQuery(d).then(function(a){b.resolve(a.results[0].value[0])},function(a){b.reject(a)}),b.promise},j.saveExternalAvatar=function(a){var f=c.defer();return b({method:"PUT",headers:{"Content-Type":"application/json"},url:e.api.endPoint+d.user.ownAvatar,data:'"'+a+'"'}).then(function(){j.fetchOwnUser().then(function(a){f.resolve(a)},function(a){f.reject(a)})},function(a){f.reject(a)}),f.promise},j}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("PortfolioSvc",["$http","$q","$timeout","breeze","PATHS","ENV",function(a,b,c,d,e,f){var g={},h=[],i=new d.DataService({serviceName:f.api.endPoint+e.public,hasServerMetadata:!1}),j=new d.EntityManager({dataService:i});return g.setPortfolio=function(a){switch(!0){case _.isArray(a):h=a;break;case _.isUndefined(a):case _.isEmpty(a):h.empty();break;case _.isObject(a):h.empty(),h.push(a)}},g.getPortfolio=function(){return h},g.fetchPortfolio=function(a){var c=b.defer(),e=new d.EntityQuery("Showcases").where("SellerProfileID","eq",a).expand(["Items.File","Items.Thumbnail","Items.Title.Literals"].join(","));return j.executeQuery(e).then(function(a){c.resolve(_.uniq(a.results[0].value))},function(a){c.reject(a)}),c.promise},g.fetchShowcases=function(c){var d=b.defer(),g=[f.api.endPoint+e.offerManagement.ownOffers,"/",c,"/Showcases"].join("");return a.get(g).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},g.saveUrls=function(b,c){var d=b instanceof Array?b:new Array(b);return a.put(f.api.endPoint+e.sellerManagement.showcases+c,d)},g.saveShowcases=function(b,c){return a({method:"PUT",url:[f.api.endPoint+e.offerManagement.ownOffers,"/",b,"/Showcases"].join(""),data:c})},g.updateShowcaseTitle=function(b){return a({method:"PATCH",url:[f.api.endPoint,e.sellerManagement.ownShowcase,"/",b.ID].join(""),data:{Title:b.Title}})},g.deleteShowcase=function(b){return a.delete(f.api.endPoint+e.sellerManagement.ownShowcase+"/"+b)},g}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("ReviewSvc",["$q","$http","breeze","PATHS","ENV",function(a,b,c,d,e){var f={},g=new c.DataService({serviceName:e.api.endPoint+d.public,hasServerMetadata:!1}),h=new c.EntityManager({dataService:g});return f.fetchReviews=function(b){var d=a.defer(),e=new c.EntityQuery("SellerReviews").expand("User, Text.Literals").where("SellerProfile.ID","eq",b);return h.executeQuery(e).then(function(a){d.resolve(_.filter(a.results[0].value,function(a){return""!==a.Text.Literals[0].Text}))},function(a){d.reject(a)}),d.promise},f}])}(),function(){"use strict";var a=angular.module("fvApp");a.service("NotificationSvc",["$http","$q","$alert",function(a,b,c){var d={};return d.show=function(a){var d=c(a),e=b.defer();return e.resolve(d),e.promise},d}])}();